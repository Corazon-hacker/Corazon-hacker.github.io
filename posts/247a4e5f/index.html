<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/006.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/6.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Sans SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script src="https://kit.fontawesome.com/b1f8a1a551.js" crossorigin="anonymous"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"www.mcorazon.top",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:"default"},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#00f",save:"manual"},fancybox:!0,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"buttons",active:"gitalk",storage:!0,lazyload:!1,nav:null,activeClass:"gitalk"},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><link rel="stylesheet" href="/css/head.css"><meta name="description" content="vim的使用 什么是 vim？ Vim是从 vi 发展出来的一个文本编辑器。代码补完、编译及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用。vim 的官方网站 (http:&#x2F;&#x2F;www.vim.org) vim 键盘图：  基本上vi可以分为三种状态：   命令模式（command mode)   插入模式（Insert mode)   底行模式（last line mode)"><meta property="og:type" content="article"><meta property="og:title" content="【Linux】Vim使用及文本处理"><meta property="og:url" content="https://www.mcorazon.top/posts/247a4e5f/index.html"><meta property="og:site_name" content="MCorazon"><meta property="og:description" content="vim的使用 什么是 vim？ Vim是从 vi 发展出来的一个文本编辑器。代码补完、编译及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用。vim 的官方网站 (http:&#x2F;&#x2F;www.vim.org) vim 键盘图：  基本上vi可以分为三种状态：   命令模式（command mode)   插入模式（Insert mode)   底行模式（last line mode)"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.mcorazon.top/posts/247a4e5f//11de8c1d4c8385c025ede918e03b6a86.gif"><meta property="og:image" content="https://www.mcorazon.top/posts/247a4e5f//1cee092565d316d1462ddbf987fbc6e1.png"><meta property="og:image" content="https://www.mcorazon.top/posts/247a4e5f//90d3f3acdaa32af011e62e7be564f47c.png"><meta property="og:image" content="https://www.mcorazon.top/posts/247a4e5f//91c28994d6fb98e8c35f2eac36880df2.jpeg"><meta property="og:image" content="https://www.mcorazon.top/posts/247a4e5f//image-20250219211455837.png"><meta property="og:image" content="https://www.mcorazon.top/posts/247a4e5f//d45d394db034998c8059e647e321a13d.png"><meta property="article:published_time" content="2025-02-19T09:00:19.000Z"><meta property="article:modified_time" content="2025-07-22T06:14:21.172Z"><meta property="article:author" content="Corazon"><meta property="article:tag" content="Linux"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.mcorazon.top/posts/247a4e5f//11de8c1d4c8385c025ede918e03b6a86.gif"><link rel="canonical" href="https://www.mcorazon.top/posts/247a4e5f/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>【Linux】Vim使用及文本处理 | MCorazon</title><script type="text/javascript" src="/js/tag/bubble.js"></script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">MCorazon</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description"><font color="#ffffff" font-size="8em">强者,绝非偶然</font></p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li><li class="menu-item menu-item-commonweal"><a href="/commonweal/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.mcorazon.top/posts/247a4e5f/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/006.png"><meta itemprop="name" content="Corazon"><meta itemprop="description" content="<font color="#000000">这世界总有黑夜<br>可我们总发着光</font>"> </span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="MCorazon"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">【Linux】Vim使用及文本处理</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2025-02-19 17:00:19" itemprop="dateCreated datePublished" datetime="2025-02-19T17:00:19+08:00">2025-02-19</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-07-22 14:14:21" itemprop="dateModified" datetime="2025-07-22T14:14:21+08:00">2025-07-22</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux/Linux%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">Linux基础</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>48k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>44 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="vim的使用">vim的使用</h2><h3 id="什么是-vim？">什么是 vim？</h3><p>Vim是从 vi 发展出来的一个文本编辑器。代码补完、编译及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用。vim 的官方网站 (<a target="_blank" rel="noopener" href="http://www.vim.org/">http://www.vim.org</a>)</p><p>vim 键盘图：</p><p><img src="/images/loading.jpeg" data-original="/posts/247a4e5f//11de8c1d4c8385c025ede918e03b6a86.gif" alt="img"></p><p>基本上vi可以分为三种状态：</p><ul class="lvl-0"><li class="lvl-2"><p>命令模式（command mode)</p></li><li class="lvl-2"><p>插入模式（Insert mode)</p></li><li class="lvl-2"><p>底行模式（last line mode)</p></li></ul><span id="more"></span><h3 id="vi-vim的三种模式">vi/vim的三种模式</h3><p>vi/vim主要分为三种模式，分别是<strong>命令模式（Command mode）</strong>，<strong>输入模式（Insert mode）**和**底线命令模式（Last line mode）</strong>。</p><p><img src="/images/loading.jpeg" data-original="/posts/247a4e5f//1cee092565d316d1462ddbf987fbc6e1.png" alt="img"></p><p>这三种模式的作用分别是：</p><h4 id="输入模式">输入模式</h4><p>在命令模式下输入插入命令i、附加命令a 、打开命令o、修改命令c、取代命令r或替换命令s都可以进入文本输入模式。在该模式下，用户输入的任何字符都被Vi当做文件内容保存起来，并将其显示在屏幕上。在文本输入过程中，若想回到命令模式下，按键ESC即可。</p><h4 id="命令模式">命令模式</h4><p>用户刚刚启动 vi/vim，便进入了命令模式。 任何时候，不管用户处于何种模式，只要按一下ESC键，即可使Vi进入命令模式；</p><p>此状态下敲击键盘动作会被Vim识别为命令，输入<code>:</code> 可切换到<strong>底线命令模式</strong>，以在最底一行输入命令。</p><p>若想要编辑文本：启动Vim，进入了命令模式，按下i，切换到输入模式。</p><h4 id="底行模式">底行模式</h4><p>在命令模式下按下:（英文冒号）就进入了底行命令模式。</p><p>底线命令模式可以输入单个或多个字符的命令，可用的命令非常多。</p><p>在底线命令模式中，基本的命令有（已经省略了冒号）：</p><ul class="lvl-0"><li class="lvl-2"><p>q 退出程序</p></li><li class="lvl-2"><p>w 保存文件</p></li></ul><p>按ESC键可随时退出底线命令模式。</p><h3 id="vim基础操作">vim基础操作</h3><h4 id="进入输入模式-Insert-mode">进入输入模式(Insert mode)</h4><p><img src="/images/loading.jpeg" data-original="/posts/247a4e5f//90d3f3acdaa32af011e62e7be564f47c.png" alt="1574384484673"></p><ul class="lvl-0"><li class="lvl-2"><p>i: 插入光标前一个字符</p></li><li class="lvl-2"><p>I: 插入行首</p></li><li class="lvl-2"><p>a: 插入光标后一个字符</p></li><li class="lvl-2"><p>A: 插入行未</p></li><li class="lvl-2"><p>o: 向下新开一行,插入行首</p></li><li class="lvl-2"><p>O: 向上新开一行,插入行首</p></li></ul><p>在进入输入模式后， vi 画面的左下角处会出现『–INSERT–』的字样</p><h4 id="进入替换模式-Replace-mode">进入替换模式(Replace mode)</h4><ul class="lvl-0"><li class="lvl-2"><p>r : 只会取代光标所在的那一个字符一次</p></li><li class="lvl-2"><p>R: 会一直取代光标所在的文字，直到按下ESC为止</p></li></ul><p>在进入输入模式后， vi 画面的左下角处会出现『–REPLACE–』的字样</p><h4 id="命令模式常用命令">命令模式常用命令</h4><h5 id="移动光标">移动光标</h5><table><thead><tr><th>移动光标的方法</th><th></th></tr></thead><tbody><tr><td>h 或 向左箭头键(←)</td><td>光标向左移动一个字符</td></tr><tr><td>j 或 向下箭头键(↓)</td><td>光标向下移动一个字符</td></tr><tr><td>k 或 向上箭头键(↑)</td><td>光标向上移动一个字符</td></tr><tr><td>l 或 向右箭头键(→)</td><td>光标向右移动一个字符</td></tr><tr><td>向下移动 30 行，可以使用 “30j” 或 “30↓” 的组合按键</td><td></td></tr><tr><td>[Ctrl] + [f]</td><td>屏幕『向下』移动一页，相当于 [Page Down]按键 (常用)</td></tr><tr><td>[Ctrl] + [b]</td><td>屏幕『向上』移动一页，相当于 [Page Up] 按键 (常用)</td></tr><tr><td>[Ctrl] + [d]</td><td>屏幕『向下』移动半页</td></tr><tr><td>[Ctrl] + [u]</td><td>屏幕『向上』移动半页</td></tr><tr><td>+</td><td>光标移动到非空格符的下一行</td></tr><tr><td>-</td><td>光标移动到非空格符的上一行</td></tr><tr><td>n</td><td>表示空格光标向右移动这一行的 n 个字符。例如 20 则光标会向后面移动 20 个字符距离。</td></tr><tr><td>0 或功能键[Home]</td><td>这是数字『 0 』：移动到这一行的最前面字符处 (常用)</td></tr><tr><td>$ 或功能键[End]</td><td>移动到这一行的最后面字符处(常用)</td></tr><tr><td>H</td><td>光标移动到这个屏幕的最上方那一行的第一个字符</td></tr><tr><td>M</td><td>光标移动到这个屏幕的中央那一行的第一个字符</td></tr><tr><td>L</td><td>光标移动到这个屏幕的最下方那一行的第一个字符</td></tr><tr><td>G</td><td>移动到这个文档的最后一行(常用)</td></tr><tr><td>nG</td><td>n 为数字。移动到这个文件的第 n 行。例如 20G 则会移动到这个文件的第 20 行(可配合 :set nu)</td></tr><tr><td>gg</td><td>移动到这个文档的第一行，相当于 1G</td></tr><tr><td>n</td><td>n 为数字。光标向下移动 n 行(常用)</td></tr></tbody></table><h5 id="删除操作">删除操作</h5><table><thead><tr><th>删除操作</th><th>删除后会添加到剪切板，相当于剪切</th></tr></thead><tbody><tr><td>x, X</td><td>x为向后删除一个字符 (相当于 [del] 按键)， X为向前删除一个字符(相当于 [backspace] )</td></tr><tr><td>nx</td><td>n 为数字，连续向后删除 n 个字符。例如10x表示连续删除 10 个字符。</td></tr><tr><td>dd</td><td>删除光标所在的一整行(常用)</td></tr><tr><td>ndd</td><td>n 为数字。删除光标所在的向下 n 行，例如 20dd 则是删除 20 行</td></tr><tr><td>d1G</td><td>删除光标所在行到首行的所有数据</td></tr><tr><td>dG</td><td>删除光标所在行到最后一行的所有数据</td></tr><tr><td>d$</td><td>删除光标所在位置到该行的最后一个字符</td></tr><tr><td>d0</td><td>删除光标所在位置到该行的最前面一个字符</td></tr></tbody></table><h5 id="撤销-复原-重复">撤销&amp;复原&amp;重复</h5><table><thead><tr><th>撤销&amp;复原</th><th></th></tr></thead><tbody><tr><td>u</td><td>撤销操作，相对于普通编辑器里面的ctrl+z</td></tr><tr><td>Ctrl+r</td><td>恢复操作，相对于普通编辑器里面的ctrl+y</td></tr><tr><td>.</td><td>就是小数点！可重复前一个动作</td></tr></tbody></table><h5 id="复制-粘贴">复制&amp;粘贴</h5><table><thead><tr><th>复制&amp;粘贴</th><th></th></tr></thead><tbody><tr><td>yy</td><td>复制光标所在行</td></tr><tr><td>nyy</td><td>n 为数字。复制光标所在的向下 n 行，例如 20yy 则是复制 20 行</td></tr><tr><td>y1G</td><td>复制光标所在行到第一行的所有数据</td></tr><tr><td>yG</td><td>复制光标所在行到最后一行的所有数据</td></tr><tr><td>y0</td><td>复制光标所在的那个字符到该行行首的所有数据</td></tr><tr><td>y$</td><td>复制光标所在的那个字符到该行行尾的所有数据</td></tr><tr><td>p, P</td><td>p 为将已复制的数据在光标下一行贴上，P 则为贴在光标上一行！</td></tr></tbody></table><h5 id="合成行">合成行</h5><ul class="lvl-0"><li class="lvl-2"><p>J: 将光标所在行与下一行的数据结合成同一行</p></li></ul><h5 id="搜索">搜索</h5><table><thead><tr><th>搜索</th><th></th></tr></thead><tbody><tr><td>/word</td><td>向光标之下寻找一个名称为 word 的字符串。</td></tr><tr><td>?word</td><td>向光标之上寻找一个字符串名称为 word 的字符串。</td></tr><tr><td>n</td><td>代表重复前一个搜寻的动作，根据前面输入的/word还是?word向下或向上搜索下一个匹配的字符串。</td></tr><tr><td>N</td><td>表示反向搜索，与n的搜索方向相反。</td></tr></tbody></table><h5 id="替换">替换</h5><table><thead><tr><th>替换</th><th></th></tr></thead><tbody><tr><td>:n1,n2s/word1/word2/g</td><td>在第 n1 与 n2 行之间寻找word1并替换为word2！比如『:100,200s/vbird/VBIRD/g』表示在100到200行之间将vbird替换为VBIRD</td></tr><tr><td><code>:1,$s/word1/word2/g</code> 或 <code>:%s/word1/word2/g</code></td><td>$表示最后一行，%s表示所有行。</td></tr><tr><td><code>:1,$s/word1/word2/gc</code> 或 <code>:%s/word1/word2/gc</code></td><td>gc中的c表示取代前显示提示字符给用户确认 (confirm) ！</td></tr></tbody></table><h5 id="底行命令模式的常用操作">底行命令模式的常用操作</h5><table><thead><tr><th>底行命令模式</th><th></th></tr></thead><tbody><tr><td>:w</td><td>保存编辑数据</td></tr><tr><td>:w!</td><td>若文件属性为『只读』时，强制写入该文件。不过，到底能不能写入， 还是跟你对该文件的文件权限有关啊！</td></tr><tr><td>:q</td><td>离开 vi</td></tr><tr><td>:q!</td><td>若曾修改过文件，又不想储存，使用 ! 为强制离开不储存文件。</td></tr><tr><td>惊叹号 (!) 在 vi 当中，常常具有『强制』的意思～</td><td></td></tr><tr><td>:wq</td><td>储存后离开，若为 :wq! 则为强制储存后离开</td></tr><tr><td>ZZ</td><td>若文件没有更动，则不储存离开，若文件已经被更动过，则储存后离开！</td></tr><tr><td>:w [filename]</td><td>另存为</td></tr><tr><td>:r [filename]</td><td>将另一个文件『filename』的数据加到光标所在行后面</td></tr><tr><td>:n1,n2 w [filename]</td><td>将 n1 到 n2 行的内容储存成 filename 这个文件。</td></tr><tr><td>:! command</td><td>暂时离开 vi 到指令行模式下执行 command 的显示结果！例如 『:! ls /home』即可在 vi 当中察看 /home 底下以 ls 输出的文件信息！</td></tr><tr><td>:set nu</td><td>会在每一行的前缀显示该行的行号</td></tr><tr><td>:set nonu</td><td>取消行号显示</td></tr></tbody></table><p>示例：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">将当前路径插入到光标的下一行</span><br><span class="line"><span class="symbol">:r!pwd</span></span><br></pre></td></tr></table></figure><h4 id="可视模式">可视模式</h4><p>v 进入字符可视化模式： 文本选择是以字符为单位的。<br>V 进入行可视化模式： 文本选择是以行为单位的。<br>Ctrl+v 进入块可视化模式 ： 选择一个矩形内的文本。</p><p>可视模式下可进行如下操作：</p><table><thead><tr><th>可视模式操作</th><th></th></tr></thead><tbody><tr><td>A</td><td>在选定的部分后面插入内容</td></tr><tr><td>I</td><td>在选定的部分前面插入内容</td></tr><tr><td>d</td><td>删除选定的部分</td></tr><tr><td>c</td><td>删除选定的部分并进入插入模式（有批量替换效果）</td></tr><tr><td>r</td><td>把选定的部分全部替换为指定的单个字符</td></tr><tr><td><code>&gt;&gt;</code></td><td>向右缩进一个单位，更适合行可视化模式</td></tr><tr><td><code>&lt;&lt;</code></td><td>向左缩进一个单位，更适合行可视化模式</td></tr><tr><td><code>gu</code></td><td>选中区域转为小写</td></tr><tr><td><code>gU</code></td><td>选中区域转为大写</td></tr><tr><td><code>g~</code></td><td>大小写互调</td></tr></tbody></table><p>可视模式下，选中的区域是由两个端点来界定的（一个在左上角，一个在右下角），在默认情况下只可以控制右下角的端点，而使用<code>o</code>按键则可以在左上角和右下角之间切换控制端点。</p><h3 id="VIM快速复习">VIM快速复习</h3><h4 id="按-冒号即可进入last-line-mode">按:冒号即可进入last line mode</h4><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">:set</span> nu 列出行号</span><br><span class="line"><span class="symbol">:set</span> nonu	取消行号</span><br><span class="line"><span class="symbol">:</span><span class="comment">#7 跳到文件中的第7行</span></span><br><span class="line">/keyword 查找字符  按n向下</span><br><span class="line"><span class="string">?k</span>eyword 查找字符  按N向下</span><br><span class="line"><span class="symbol">:n1</span>,n2/word1/word2/gc  替换指定范围单词，c表示提示</span><br><span class="line"><span class="symbol">:w</span> 保存文件</span><br><span class="line"><span class="symbol">:w</span> filename 以指定的文件名另存</span><br><span class="line"><span class="symbol">:n1</span>,n2 w [filename]	将 n1 到 n2行另存</span><br><span class="line"><span class="symbol">:r</span> [filename]	读入另一个文件加到光标所在行后面</span><br><span class="line"><span class="symbol">:</span>! ls /home  在vi当中察看ls输出信息！</span><br><span class="line"><span class="symbol">:q</span>离开vi</span><br><span class="line"><span class="symbol">:wq</span> 和 <span class="symbol">:ZZ</span> 和 <span class="symbol">:x</span> 保存并退出vi</span><br><span class="line">!强制执行</span><br><span class="line"><span class="symbol">:%</span> s/^<span class="regexp">/#/g</span> 来在全部内容的行首添加 <span class="comment"># 号注释</span></span><br><span class="line"><span class="symbol">:</span><span class="number">1</span>,<span class="number">10</span> s/^<span class="regexp">/#/g</span> 在<span class="number">1</span>~<span class="number">10</span> 行首添加 <span class="comment"># 号注释  </span></span><br></pre></td></tr></table></figure><h4 id="从command-mode进入Insert-mode">从command mode进入Insert mode</h4><p>按i在当前位置编辑按a在当前位置的下一个字符编辑按o插入新行，从行首开始编辑按R(Replace mode)：R会一直取代光标所在的文字，直到按下 ESC为止；(常用)</p><h4 id="按ESC键退回command-mode">按ESC键退回command mode</h4><p>h←j↓k↑l→前面加数字移动指定的行数或字符数<br>1、翻页bu上下整页，ud上下半页</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ctrl+<span class="selector-tag">b</span>：上移一页。</span><br><span class="line">ctrl+f：下移一页。</span><br><span class="line">ctrl+u：上移半页。</span><br><span class="line">ctrl+d：下移半页。</span><br></pre></td></tr></table></figure><p>2、行定位</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">7gg</span>或<span class="number">7</span>G：定位第<span class="number">7</span>行首字符。(可能只在Vim中有效)</span><br><span class="line"><span class="attribute">G</span>：移动到文章的最后。</span><br><span class="line"><span class="attribute">7H</span>:当前屏幕的第<span class="number">7</span>行行首</span><br><span class="line"><span class="attribute">M</span>：当前屏幕中间行的行首</span><br><span class="line"><span class="attribute">7L</span>:当前屏幕的倒数第<span class="number">7</span>行行首</span><br></pre></td></tr></table></figure><p>3、当前行定位</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$：</span>移动到光标所在行的“行尾”。</span><br><span class="line"><span class="number">0</span>或^：移动到光标所在行的“行首”</span><br><span class="line">w：光标跳到下个单词的开头</span><br><span class="line">e：光标跳到下个单词的字尾</span><br><span class="line">b：光标回到上个单词的开头</span><br></pre></td></tr></table></figure><p>4、编辑</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">x：剪切当前字符</span><br><span class="line">7x：剪切从当前位置起7个字符</span><br><span class="line">大写的X，表示从前面一个字符开始往前计算</span><br><span class="line"><span class="built_in">dd</span>：剪切光标所在行。</span><br><span class="line">7dd：从光标所在行开始剪切7行</span><br><span class="line">d7G	删除光标所在到第7行的所有数据</span><br><span class="line">yw：复制当前单词</span><br><span class="line">7yw：复制从当前位置起7个单词</span><br><span class="line">yy：复制当前行</span><br><span class="line">6yy：从当前行起向下复制6行</span><br><span class="line">y7G	复制游标所在列到第7列的所有数据</span><br><span class="line">p：粘贴</span><br><span class="line">u：撤销</span><br><span class="line">ctrl+r：取消撤销</span><br><span class="line">cw：删除当前单词(从光标位置开始计算)，并进入插入模式</span><br><span class="line">c7w：删除7个单词并进入插入模式</span><br></pre></td></tr></table></figure><h4 id="多行编辑，vim支持，vi不支持">多行编辑，vim支持，vi不支持</h4><p>按ctrl+V进入块模式，上下键选中快，按大写G选择到末尾，上下左右键移动选择位置按大写I进去编辑模式，输入要插入的字符，编辑完成按ESC退出选中要替换的字符后，按c键全部会删除，然后输入要插入的字符，编辑完成按ESC退出选中要替删除的字符后，按delete键，则会全部删除</p><p>按shift+V可进入行模式，对指定行操作</p><h3 id="vim练习">vim练习</h3><p>1、创建目录/tmp/test，将/etc/man.config复制到该目录下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">mkdir</span> -p /tmp/test</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cp</span> /etc/man.config /tmp/test/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cd</span> /tmp/test/</span></span><br></pre></td></tr></table></figure><p>2、用vim编辑man.config文件：</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim man.config</span><br></pre></td></tr></table></figure><p>3、设置显示行号； 移动到第58行，向右移动40个字符，查看双引号内的是什么目录；</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">：<span class="keyword">set</span> nu</span><br><span class="line">58G 或<span class="comment">58gg</span> </span><br><span class="line">40-&gt; 或40空格 目录为：/dir/bin/foo </span><br></pre></td></tr></table></figure><p>4、移动到第一行，并向下查找“bzip2”这个字符串，它在第几行；</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">移动到最后一行，并向上查找该字符串；</span><br><span class="line">gg 或1G</span><br><span class="line">/bzip 137行 ?bzip2</span><br></pre></td></tr></table></figure><p>5、将50行到100行之间的man更改为MAN，并且 逐个挑选 是否需要修改；</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">若在挑选过程中一直按y，结果会在最后一行出现改变了几个<span class="built_in">man</span>?</span><br><span class="line">:<span class="number">50</span>,<span class="number">100</span>s/<span class="built_in">man</span>/<span class="built_in">MAN</span>/<span class="built_in">gc</span> <span class="number">25</span>次替换</span><br></pre></td></tr></table></figure><p>6、修改完后，突然反悔了，要全部复原，有哪些方法？</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">一直按u键	</span><br><span class="line">或者</span><br><span class="line"><span class="symbol">:q!</span>强制不保存退出后，再重新打开该文件</span><br></pre></td></tr></table></figure><p>7、复制65到73这9行的内容（含有MANPATH_MAP），并且粘贴到最后一行之后；</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">65gg</span>或<span class="number">65</span>G到该行后，<span class="number">9</span>yy,G 移动到最后一行，p粘贴</span><br></pre></td></tr></table></figure><p>8、21行到42行之间开头为#符号的批注数据不要了，如何删除；</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">21G</span>到该行 <span class="number">22</span>dd</span><br></pre></td></tr></table></figure><p>9、将这个文件另存为man.test.config的文件</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:w <span class="keyword">man</span>.<span class="keyword">test</span>.config</span><br></pre></td></tr></table></figure><p>10、到第27行，并且删除15个字符，结果出现的第一个字符是什么？</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">27gg</span> 后<span class="number">15</span>x</span><br></pre></td></tr></table></figure><p>11、在第一行新增一行，在该行内输入“I am a student ”</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">gg</span>到第一行 <span class="built_in">O</span>输入即可 说明：<span class="variable">o</span>是在当前行之后插入一行，<span class="built_in">O</span>是在当前行之前插入一行</span><br></pre></td></tr></table></figure><p>12、保存并退出</p><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">:wq</span></span><br></pre></td></tr></table></figure><h2 id="正则表达式（待写）">正则表达式（待写）</h2><h2 id="Linux管道命令">Linux管道命令</h2><p>Linux的管道命令是’|’，通过它可以对数据进行连续处理，其示意图如下：</p><p><img src="/images/loading.jpeg" data-original="/posts/247a4e5f//91c28994d6fb98e8c35f2eac36880df2.jpeg" alt="img"></p><p>注意：</p><p>1）管道命令仅处理标准输出，对于标准错误输出，将忽略</p><p>2）管道命令右边命令，必须能够接收标准输入流命令才行，否则传递过程中数据会抛弃。</p><p>常用来作为接收数据管道命令有： less,more,head,tail，而ls, cp, mv就不行。</p><h4 id="wc-统计字数">wc - 统计字数</h4><p>可以计算文件的Byte数、字数、或是列数，若不指定文件名称、或是所给予的文件名为&quot;-&quot;，则wc指令会从标准输入设备读取数据。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">wc</span> [-lwm] [filename]</span><br><span class="line">-l: 统计行数</span><br><span class="line">-w：统计英文单词</span><br><span class="line">-m：统计字符数</span><br><span class="line">python@xxx:~$ <span class="built_in">wc</span> -l /etc/passwd</span><br><span class="line">49 /etc/passwd</span><br><span class="line">python@xxx:~$ <span class="built_in">wc</span> -w /etc/passwd</span><br><span class="line">81 /etc/passwd</span><br><span class="line">python@xxx:~$ <span class="built_in">wc</span> -m /etc/passwd</span><br><span class="line">2696 /etc/passwd</span><br><span class="line">12345678910</span><br></pre></td></tr></table></figure><p>在默认的情况下，wc将计算指定文件的行数、字数，以及字节数。使用的命令为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">wc</span> testfile           <span class="comment"># testfile文件的统计信息  </span></span><br><span class="line">3 92 598 testfile       <span class="comment"># testfile文件的行数为3、单词数92、字节数598 </span></span><br><span class="line">12</span><br></pre></td></tr></table></figure><p>其中，3 个数字分别表示testfile文件的行数、单词数，以及该文件的字节数。</p><p>如果想同时统计多个文件的信息，例如同时统计testfile、testfile_1、testfile_2，可使用如下命令：</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ wc testfile testfile_1 testfile_2  <span class="comment">#统计三个文件的信息  </span></span><br><span class="line">3<span class="number"> 92 </span>598 testfile                    <span class="comment">#第一个文件行数为3、单词数92、字节数598  </span></span><br><span class="line">9<span class="number"> 18 </span>78 testfile_1                   <span class="comment">#第二个文件的行数为9、单词数18、字节数78  </span></span><br><span class="line">3<span class="number"> 6 </span>32 testfile_2                    <span class="comment">#第三个文件的行数为3、单词数6、字节数32  </span></span><br><span class="line">15<span class="number"> 116 </span>708 总用量                    <span class="comment">#三个文件总共的行数为15、单词数116、字节数708 </span></span><br><span class="line">12345</span><br></pre></td></tr></table></figure><h4 id="cut-列选取命令">cut - 列选取命令</h4><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">选项与参数：</span><br><span class="line"><span class="deletion">-d  ：后面接分隔字符。与 -f 一起使用；</span></span><br><span class="line"><span class="deletion">-f  ：依据 -d 的分隔字符将一段信息分割成为数段，用 -f 取出第几段的意思；</span></span><br><span class="line"><span class="deletion">-c  ：以字符 (characters) 的单位取出固定字符区间；</span></span><br><span class="line">1234</span><br></pre></td></tr></table></figure><p>cut以行为单位，根据分隔符把行分成若干列，这样就可以指定选取哪些列了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cut</span> -d <span class="string">&#x27;分隔字符&#x27;</span> -f 选取的列数</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span>|<span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f 2  	--选取第2列</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span>|<span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f 3,5  	--选取第3列和第5列</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span>|<span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f 3-5  	--选取第3列到第5列</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span>|<span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f 3-   	--选取第3列到最后1列</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span>|<span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f 1-3,5	--选取第1到第3列还有第5列</span><br><span class="line">123456</span><br></pre></td></tr></table></figure><p>只显示/etc/passwd的用户和shell：</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#cat /etc/passwd | cut -d <span class="string">&#x27;:&#x27;</span> -f 1,7 </span></span><br><span class="line"><span class="symbol">root:</span><span class="keyword">/bin/</span>bash</span><br><span class="line"><span class="symbol">daemon:</span><span class="keyword">/bin/</span>sh</span><br><span class="line"><span class="symbol">bin:</span><span class="keyword">/bin/</span>sh</span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure><h4 id="grep-行选取命令">grep - 行选取命令</h4><p>grep一般格式为：</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grep</span> [-cinv] <span class="string">&#x27;查找的字符串&#x27;</span> filename</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p>在grep命令中输入字符串参数时，最好引号或双引号括起来。例如：<code>grep 'a' 1.txt</code>。</p><p>常用选项说明：</p><table><thead><tr><th>选项</th><th>含义</th></tr></thead><tbody><tr><td>-v</td><td>显示不包含匹配文本的所有行（相当于求反）</td></tr><tr><td>-n</td><td>显示匹配行及行号</td></tr><tr><td>-i</td><td>忽略大小写</td></tr><tr><td>-c</td><td>计算找到的行数</td></tr></tbody></table><p>grep搜索内容串可以是正则表达式，常用正则表达式：</p><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>^a</td><td>行首,搜寻以 m 开头的行；grep -n ‘^a’ 1.txt</td></tr><tr><td>ke$</td><td>行尾,搜寻以 ke 结束的行；grep -n ‘ke$’ 1.txt</td></tr><tr><td>[Ss]igna[Ll]</td><td>匹配 [] 里中一系列字符中的一个；搜寻匹配单词signal、signaL、Signal、SignaL的行；grep -n ‘[Ss]igna[Ll]’ 1.txt</td></tr><tr><td>.</td><td>.匹配一个非换行符的字符；grep -n ‘e.e’ 1.txt可以匹配 eee，eae，eve，但是不匹配 ee，eaae；</td></tr><tr><td>*</td><td>匹配零个或多个先前字符</td></tr><tr><td>[^]</td><td>匹配一个不在指定范围内的字符</td></tr><tr><td><code>\(..\)</code></td><td>标记匹配字符</td></tr><tr><td>\</td><td>锚定单词的开始</td></tr><tr><td><code>\&lt;</code></td><td>锚定单词的开头</td></tr><tr><td><code>\&gt;</code></td><td>锚定单词的结束</td></tr><tr><td><code>x\&#123;m\&#125;</code></td><td>重复字符x，m次</td></tr><tr><td><code>x\&#123;m,\&#125;</code></td><td>重复字符x,至少m次</td></tr><tr><td><code>x\&#123;m,n\&#125;</code></td><td>重复字符x，至少m次，不多于n次</td></tr><tr><td>\w</td><td>匹配文字和数字字符，也就是[A-Za-z0-9]</td></tr><tr><td>\b</td><td>单词锁定符</td></tr></tbody></table><p>实例：显示所有以“h”结尾的行<br>grep h$<br>匹配所有以“a”开头且以“e”结尾的，中间包含2个字符的单词<br>grep ‘&lt;a…e&gt;’<br>显示所有包含一个”y”或”h”字符的行<br>grep [yh]<br>显示不包含字母a~k 且后紧跟“pple”的单词</p><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep [<span class="symbol">^a</span>-<span class="keyword">k</span>]pple</span><br></pre></td></tr></table></figure><p>从系统词典中选择所有以“c”开头且以“o”结尾的单词<code>grep '\&lt;c.*o\&gt;'</code><br>找出一个文件中或者输出中找到包含<code>*</code>的行<code>grep '\*'</code><br>显示所有包含每个字符串至少有20个连续字母的单词的行<br><code>grep [a-Z]\&#123;20,\&#125;</code></p><h4 id="sort-排序">sort - 排序</h4><p><strong>语法：</strong></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sort</span> [-fbMnrtuk] [<span class="built_in">file</span> <span class="keyword">or</span> <span class="keyword">stdin</span>]</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p><strong>参数说明</strong>：</p><ul class="lvl-0"><li class="lvl-2"><p>-f ：忽略大小写的差异，例如 A 与 a 视为编码相同；</p></li><li class="lvl-2"><p>-b ：忽略最前面的空格符部分；</p></li><li class="lvl-2"><p>-M ：以月份的名字来排序，例如 JAN, DEC 等等的排序方法；</p></li><li class="lvl-2"><p>-n ：使用『纯数字』进行排序(默认是以文字型态来排序的)；</p></li><li class="lvl-2"><p>-r ：反向排序；</p></li><li class="lvl-2"><p>-u ：就是 uniq ，相同的数据中，仅出现一行代表；</p></li><li class="lvl-2"><p>-t ：分隔符，默认是用 [tab] 键来分隔；</p></li><li class="lvl-2"><p>-k ：以哪个区间 (field) 来进行排序</p></li></ul><p>默认是以第一个字符升序排序:</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat /etc/passwd | sort </span></span><br><span class="line"><span class="symbol">adm:</span><span class="symbol">x:</span><span class="number">3</span><span class="symbol">:</span><span class="number">4</span><span class="symbol">:adm</span><span class="symbol">:/var/adm</span><span class="symbol">:/sbin/nologin</span></span><br><span class="line">avahi-<span class="symbol">autoipd:</span><span class="symbol">x:</span><span class="number">100</span><span class="symbol">:</span><span class="number">156</span><span class="symbol">:avahi-autoipd</span><span class="symbol">:/var/lib/avahi-autoipd</span><span class="symbol">:/sbin/nologin</span></span><br><span class="line"><span class="symbol">avahi:</span><span class="symbol">x:</span><span class="number">70</span><span class="symbol">:</span><span class="number">70</span><span class="symbol">:Avahi</span> <span class="symbol">daemon:</span>/<span class="symbol">:/sbin/nologin</span></span><br><span class="line"><span class="symbol">bin:</span><span class="symbol">x:</span><span class="number">1</span><span class="symbol">:</span><span class="number">1</span><span class="symbol">:bin</span><span class="symbol">:/bin</span><span class="symbol">:/sbin/nologin</span></span><br><span class="line">......</span><br><span class="line"><span class="number">123456</span></span><br></pre></td></tr></table></figure><p>以第3列排序：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="variable">@www</span> ~]<span class="comment"># cat /etc/passwd | sort -t &#x27;:&#x27; -k 3</span></span><br><span class="line"><span class="symbol">root:</span><span class="symbol">x:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span></span><br><span class="line"><span class="symbol">uucp:</span><span class="symbol">x:</span><span class="number">10</span><span class="symbol">:</span><span class="number">14</span><span class="symbol">:uucp</span><span class="symbol">:/var/spool/uucp</span><span class="symbol">:/sbin/nologin</span></span><br><span class="line"><span class="symbol">operator:</span><span class="symbol">x:</span><span class="number">11</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:operator</span><span class="symbol">:/root</span><span class="symbol">:/sbin/nologin</span></span><br><span class="line"><span class="symbol">bin:</span><span class="symbol">x:</span><span class="number">1</span><span class="symbol">:</span><span class="number">1</span><span class="symbol">:bin</span><span class="symbol">:/bin</span><span class="symbol">:/sbin/nologin</span></span><br><span class="line"><span class="symbol">games:</span><span class="symbol">x:</span><span class="number">12</span><span class="symbol">:</span><span class="number">100</span><span class="symbol">:games</span><span class="symbol">:/usr/games</span><span class="symbol">:/sbin/nologin</span></span><br><span class="line"><span class="number">123456</span></span><br></pre></td></tr></table></figure><p>使用数字排序：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd | sort -t <span class="string">&#x27;:&#x27;</span> -k <span class="number">3</span>n</span><br><span class="line"><span class="symbol">root:</span><span class="symbol">x:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span></span><br><span class="line"><span class="symbol">daemon:</span><span class="symbol">x:</span><span class="number">1</span><span class="symbol">:</span><span class="number">1</span><span class="symbol">:daemon</span><span class="symbol">:/usr/sbin</span><span class="symbol">:/bin/sh</span></span><br><span class="line"><span class="symbol">bin:</span><span class="symbol">x:</span><span class="number">2</span><span class="symbol">:</span><span class="number">2</span><span class="symbol">:bin</span><span class="symbol">:/bin</span><span class="symbol">:/bin/sh</span></span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure><p>倒序排序：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/passwd | <span class="built_in">sort</span> -t <span class="string">&#x27;:&#x27;</span> -k 3nr</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</span><br><span class="line">ntp:x:106:113::/home/ntp:/bin/false</span><br><span class="line">messagebus:x:105:109::/var/run/dbus:/bin/false</span><br><span class="line">sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">或者</span><br><span class="line"><span class="built_in">cat</span> /etc/passwd | <span class="built_in">sort</span> -t <span class="string">&#x27;:&#x27;</span> -k 3 -nr</span><br><span class="line">1234567</span><br></pre></td></tr></table></figure><p>先以第六个域的第2个字符到第4个字符进行正向排序，再基于第一个域进行反向排序：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd |  sort -t <span class="string">&#x27;:&#x27;</span> -k <span class="number">6.2</span>,<span class="number">6.4</span> -k <span class="number">1</span>r      </span><br><span class="line"><span class="symbol">sync:</span><span class="symbol">x:</span><span class="number">4</span><span class="symbol">:</span><span class="number">65534</span><span class="symbol">:sync</span><span class="symbol">:/bin</span><span class="symbol">:/bin/sync</span></span><br><span class="line"><span class="symbol">proxy:</span><span class="symbol">x:</span><span class="number">13</span><span class="symbol">:</span><span class="number">13</span><span class="symbol">:proxy</span><span class="symbol">:/bin</span><span class="symbol">:/bin/sh</span></span><br><span class="line"><span class="symbol">bin:</span><span class="symbol">x:</span><span class="number">2</span><span class="symbol">:</span><span class="number">2</span><span class="symbol">:bin</span><span class="symbol">:/bin</span><span class="symbol">:/bin/sh</span></span><br><span class="line"><span class="symbol">sys:</span><span class="symbol">x:</span><span class="number">3</span><span class="symbol">:</span><span class="number">3</span><span class="symbol">:sys</span><span class="symbol">:/dev</span><span class="symbol">:/bin/sh</span></span><br><span class="line"><span class="number">12345</span></span><br></pre></td></tr></table></figure><p>查看/etc/passwd有多少个shell:</p><p>方法对/etc/passwd的第七个域排序并去重，然后统计行数：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="variable">@VM_0_9_centos</span> ~]<span class="comment"># cat /etc/passwd |  sort -t&#x27;:&#x27; -k 7 -u</span></span><br><span class="line"><span class="symbol">root:</span><span class="symbol">x:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span></span><br><span class="line"><span class="symbol">syslog:</span><span class="symbol">x:</span><span class="number">996</span><span class="symbol">:</span><span class="number">994</span><span class="symbol">:</span><span class="symbol">:/home/syslog</span><span class="symbol">:/bin/false</span></span><br><span class="line"><span class="symbol">sync:</span><span class="symbol">x:</span><span class="number">5</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:sync</span><span class="symbol">:/sbin</span><span class="symbol">:/bin/sync</span></span><br><span class="line"><span class="symbol">halt:</span><span class="symbol">x:</span><span class="number">7</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:halt</span><span class="symbol">:/sbin</span><span class="symbol">:/sbin/halt</span></span><br><span class="line"><span class="symbol">bin:</span><span class="symbol">x:</span><span class="number">1</span><span class="symbol">:</span><span class="number">1</span><span class="symbol">:bin</span><span class="symbol">:/bin</span><span class="symbol">:/sbin/nologin</span></span><br><span class="line"><span class="symbol">shutdown:</span><span class="symbol">x:</span><span class="number">6</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:shutdown</span><span class="symbol">:/sbin</span><span class="symbol">:/sbin/shutdown</span></span><br><span class="line">[root<span class="variable">@VM_0_9_centos</span> ~]<span class="comment"># cat /etc/passwd |  sort -t&#x27;:&#x27; -k 7 -u|wc -l</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">123456789</span></span><br></pre></td></tr></table></figure><h4 id="uniq-去重">uniq - 去重</h4><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">选项与参数：</span><br><span class="line"><span class="deletion">-i   ：忽略大小写字符的不同；</span></span><br><span class="line"><span class="deletion">-c  ：进行计数</span></span><br><span class="line"><span class="deletion">-u  ：只显示唯一的行</span></span><br><span class="line">1234</span><br></pre></td></tr></table></figure><p>该命令用于排完序之后，对排序结果进行去重</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python</span>@xxx:~$ last | cut -d <span class="string">&#x27; &#x27;</span> -f <span class="number">1</span>  | <span class="keyword">sort</span> | uniq</span><br><span class="line"></span><br><span class="line">haha</span><br><span class="line"><span class="keyword">python</span></span><br><span class="line">reboot</span><br><span class="line">wtmp</span><br><span class="line"><span class="keyword">python</span>@xxx:~$ last | cut -d <span class="string">&#x27; &#x27;</span> -f <span class="number">1</span>  | <span class="keyword">sort</span> | uniq -c</span><br><span class="line">      <span class="number">1</span> </span><br><span class="line">      <span class="number">2</span> haha</span><br><span class="line">     <span class="number">22</span> <span class="keyword">python</span></span><br><span class="line">      <span class="number">7</span> reboot</span><br><span class="line">      <span class="number">1</span> wtmp</span><br><span class="line"><span class="number">123456789101112</span></span><br></pre></td></tr></table></figure><p>排序文件，默认是去重：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">cat</span> words | <span class="built_in">sort</span> |<span class="built_in">uniq</span></span></span><br><span class="line">friend</span><br><span class="line">hello</span><br><span class="line">world</span><br><span class="line">1234</span><br></pre></td></tr></table></figure><p>排序之后删除了重复行，同时在行首位置输出该行重复的次数：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">sort</span> testfile | <span class="built_in">uniq</span> -c</span></span><br><span class="line">1 friend</span><br><span class="line">3 hello</span><br><span class="line">2 world</span><br><span class="line">1234</span><br></pre></td></tr></table></figure><p>仅显示存在重复的行，并在行首显示该行重复的次数：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">sort</span> testfile | <span class="built_in">uniq</span> -dc</span></span><br><span class="line">3 hello</span><br><span class="line">2 world</span><br><span class="line">123</span><br></pre></td></tr></table></figure><p>仅显示不重复的行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sort</span> testfile | <span class="built_in">uniq</span> -u</span><br><span class="line">friend</span><br><span class="line">12</span><br></pre></td></tr></table></figure><h4 id="tee-同时输出多个文件">tee - 同时输出多个文件</h4><p>从标准输入设备读取数据，将其内容输出到标准输出设备，同时保存成文件。</p><p>一般情况下用重定向实现，需要同时输出多个文件时可以使用该命令。</p><p><strong>参数</strong>：</p><ul class="lvl-0"><li class="lvl-2"><p>-a或–append 　附加到既有文件的后面，而非覆盖它．</p></li></ul><p>将输出同时保存到多个文件中，同时将输出内容显示到控制台：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">python<span class="variable">@xxx</span><span class="symbol">:~/test</span><span class="variable">$ </span>echo <span class="string">&quot;hello world&quot;</span>|tee f1 f2 </span><br><span class="line">hello world</span><br><span class="line">python<span class="variable">@xxx</span><span class="symbol">:~/test</span><span class="variable">$ </span>cat f1</span><br><span class="line">hello world</span><br><span class="line">python<span class="variable">@xxx</span><span class="symbol">:~/test</span><span class="variable">$ </span>echo <span class="string">&quot;hello world&quot;</span>|tee f1 f2 -a</span><br><span class="line">hello world</span><br><span class="line">python<span class="variable">@xxx</span><span class="symbol">:~/test</span><span class="variable">$ </span>cat f1</span><br><span class="line">hello world</span><br><span class="line">hello world</span><br><span class="line"><span class="number">123456789</span></span><br></pre></td></tr></table></figure><h4 id="tr-替换指定的字符">tr - 替换指定的字符</h4><p>不指定参数时，即表示替换指定的字符为另一个字符，支持指定的字符集合。</p><p><strong>参数说明：</strong></p><ul class="lvl-0"><li class="lvl-2"><p>-d, --delete：删除指定的字符</p></li><li class="lvl-2"><p>-s, --squeeze-repeats：缩减连续重复的字符成指定的单个字符</p></li></ul><p>字符集合的范围：</p><ul class="lvl-0"><li class="lvl-2"><p>\NNN 八进制值的字符 NNN (1 to 3 为八进制值的字符)</p></li><li class="lvl-2"><p>\ 反斜杠</p></li><li class="lvl-2"><p>\a Ctrl-G 铃声</p></li><li class="lvl-2"><p>\b Ctrl-H 退格符</p></li><li class="lvl-2"><p>\f Ctrl-L 走行换页</p></li><li class="lvl-2"><p>\n Ctrl-J 新行</p></li><li class="lvl-2"><p>\r Ctrl-M 回车</p></li><li class="lvl-2"><p>\t Ctrl-I tab键</p></li><li class="lvl-2"><p>\v Ctrl-X 水平制表符</p></li><li class="lvl-2"><p>CHAR1-CHAR2 ：字符范围从 CHAR1 到 CHAR2 的指定，范围的指定以 ASCII 码的次序为基础，只能由小到大，不能由大到小。</p></li><li class="lvl-2"><p>[CHAR*] ：这是 SET2 专用的设定，功能是重复指定的字符到与 SET1 相同长度为止</p></li><li class="lvl-2"><p>[CHAR*REPEAT] ：这也是 SET2 专用的设定，功能是重复指定的字符到设定的 REPEAT 次数为止(REPEAT 的数字采 8 进位制计算，以 0 为开始)</p></li><li class="lvl-2"><p>[:alnum:] ：所有字母字符与数字</p></li><li class="lvl-2"><p>[:alpha:] ：所有字母字符</p></li><li class="lvl-2"><p>[:blank:] ：所有水平空格</p></li><li class="lvl-2"><p>[:cntrl:] ：所有控制字符</p></li><li class="lvl-2"><p>[:digit:] ：所有数字</p></li><li class="lvl-2"><p>[:graph:] ：所有可打印的字符(不包含空格符)</p></li><li class="lvl-2"><p>[:lower:] ：所有小写字母</p></li><li class="lvl-2"><p>[:print:] ：所有可打印的字符(包含空格符)</p></li><li class="lvl-2"><p>[:punct:] ：所有标点字符</p></li><li class="lvl-2"><p>[:space:] ：所有水平与垂直空格符</p></li><li class="lvl-2"><p>[:upper:] ：所有大写字母</p></li><li class="lvl-2"><p>[:xdigit:] ：所有 16 进位制的数字</p></li><li class="lvl-2"><p>[=CHAR=] ：所有符合指定的字符(等号里的 CHAR，代表你可自订的字符)</p></li></ul><p>将文件testfile中的小写字母全部转换成大写字母：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">cat</span> <span class="selector-tag">testfile</span> |<span class="selector-tag">tr</span> <span class="selector-tag">a</span><span class="selector-tag">-z</span> <span class="selector-tag">A</span><span class="selector-tag">-Z</span> </span><br><span class="line">或</span><br><span class="line"><span class="selector-tag">cat</span> <span class="selector-tag">testfile</span> |<span class="selector-tag">tr</span> <span class="selector-attr">[:lower:]</span> <span class="selector-attr">[:upper:]</span> </span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></table></figure><p>缩减连续重复的字符成指定的单个字符：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">python<span class="variable">@xxx</span><span class="symbol">:~/test</span><span class="variable">$ </span>cat t</span><br><span class="line">dddddddsssssdd</span><br><span class="line">eeeeeeeeee</span><br><span class="line">aaaaaaaaaaaaaa</span><br><span class="line">vvvvvvvvvvvvvv</span><br><span class="line">python<span class="variable">@xxx</span><span class="symbol">:~/test</span><span class="variable">$ </span>cat t|tr -s <span class="string">&#x27;se&#x27;</span></span><br><span class="line">dddddddsdd</span><br><span class="line">e</span><br><span class="line">aaaaaaaaaaaaaa</span><br><span class="line">vvvvvvvvvvvvvv</span><br><span class="line">python<span class="variable">@xxx</span><span class="symbol">:~/test</span><span class="variable">$ </span>cat t|tr -s <span class="string">&#x27;sdeav&#x27;</span></span><br><span class="line">dsd</span><br><span class="line">e</span><br><span class="line">a</span><br><span class="line">v</span><br><span class="line"><span class="number">123456789101112131415</span></span><br></pre></td></tr></table></figure><p>删除指定的字符：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python<span class="variable">@xxx</span><span class="symbol">:~/test</span><span class="variable">$ </span>cat t|tr -d <span class="string">&#x27;dv&#x27;</span></span><br><span class="line">sssss</span><br><span class="line">eeeeeeeeee</span><br><span class="line">aaaaaaaaaaaaaa</span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure><h4 id="join-文件按行连接">join - 文件按行连接</h4><p>将两个文件中指定栏位相同的行连接起来。即按照两个文件中共同拥有的某一列，将对应的行拼接成一行。</p><p>注意：在使用join之前所处理的文件要事先经过排序。</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ cat testfile_1</span><br><span class="line">Hello 95 #例如，本例中第一列为姓名，第二列为数额  </span><br><span class="line">Linux 85  </span><br><span class="line"><span class="keyword">test </span>30  </span><br><span class="line">cmd@hdd-desktop:~$ cat testfile_2</span><br><span class="line">Hello 2005 #例如，本例中第一列为姓名，第二列为年份  </span><br><span class="line">Linux 2009  </span><br><span class="line"><span class="keyword">test </span>2006 </span><br><span class="line">12345678</span><br></pre></td></tr></table></figure><p>使用join命令，将两个文件连接：</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ join testfile_1 testfile_2 #连接testfile_1、testfile_2中的内容  </span><br><span class="line">Hello 95 2005 #连接后显示的内容  </span><br><span class="line">Linux 85 2009  </span><br><span class="line"><span class="keyword">test </span>30 2006 </span><br><span class="line">1234</span><br></pre></td></tr></table></figure><p>两个文件互换，输出结果的变化：</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ join testfile_2 testfile_1 #改变文件顺序连接两个文件  </span><br><span class="line">Hello 2005 95 #连接后显示的内容  </span><br><span class="line">Linux 2009 85  </span><br><span class="line"><span class="keyword">test </span>2006 30 </span><br><span class="line">1234</span><br></pre></td></tr></table></figure><p><strong>参数</strong>：</p><ul class="lvl-0"><li class="lvl-2"><p>-a&lt;1或2&gt; 除了显示原来的输出内容之外，还显示指令文件中没有相同栏位的行。</p></li><li class="lvl-2"><p>-e&lt;字符串&gt; 若[文件1]与[文件2]中找不到指定的栏位，则在输出中填入选项中的字符串。</p></li><li class="lvl-2"><p>-i或–igore-case 比较栏位内容时，忽略大小写的差异。</p></li><li class="lvl-2"><p>-o&lt;格式&gt; 按照指定的格式来显示结果。</p></li><li class="lvl-2"><p>-t&lt;字符&gt; 使用栏位的分隔字符。</p></li><li class="lvl-2"><p>-v&lt;1或2&gt; 跟-a相同，但是只显示文件中没有相同栏位的行。</p></li><li class="lvl-2"><p>-1&lt;栏位&gt; 连接[文件1]指定的栏位。</p></li><li class="lvl-2"><p>-2&lt;栏位&gt; 连接[文件2]指定的栏位。</p></li></ul><h4 id="paste-将多个文件对应行链接在一起">paste-将多个文件对应行链接在一起</h4><p>paste 指令会把每个文件以列对列的方式，一列列地加以合并。</p><p>语法：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">paste <span class="selector-attr">[-s]</span><span class="selector-attr">[-d &lt;间隔字符&gt;]</span><span class="selector-attr">[文件...]</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p><strong>参数</strong>：</p><ul class="lvl-0"><li class="lvl-2"><p>-d&lt;间隔字符&gt;或–delimiters=&lt;间隔字符&gt; 　用指定的间隔字符取代跳格字符。</p></li><li class="lvl-2"><p>-s或–serial 　串列进行而非平行处理。</p></li><li class="lvl-2"><p>[文件…] 指定操作的文件路径</p></li></ul><p>使用paste指令将文件&quot;file&quot;、“testfile”、&quot;testfile1&quot;进行合并，输入如下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> file                  <span class="comment">#file文件的内容</span></span>  </span><br><span class="line">xiongdan 200  </span><br><span class="line">lihaihui 233  </span><br><span class="line">lymlrl 231  </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> testfile              <span class="comment">#testfile文件的内容</span></span>  </span><br><span class="line">liangyuanm  ss  </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> testfile1             <span class="comment">#testfile1文件的内容</span></span>  </span><br><span class="line">huanggai 56  </span><br><span class="line">zhixi 73 </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">paste</span> file testfile testfile1</span></span><br><span class="line">xiongdan 200    liangyuanm ss   huanggai 56</span><br><span class="line">lihaihui 233            zhixi 73</span><br><span class="line">lymlrl 231</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">paste</span> -d <span class="string">&#x27;:&#x27;</span> file testfile testfile1</span></span><br><span class="line">xiongdan 200:liangyuanm ss:huanggai 56</span><br><span class="line">lihaihui 233::zhixi 73</span><br><span class="line">lymlrl 231::</span><br><span class="line">1234567891011121314151617</span><br></pre></td></tr></table></figure><p>参数&quot;-s&quot;可以将一个文件中的多行数据合并为一行进行显示：</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ paste -s file             <span class="comment">#合并指定文件的多行数据</span></span><br><span class="line">xiongdan<span class="number"> 200 </span>lihaihui<span class="number"> 233 </span>lymlrl<span class="number"> 231 </span></span><br><span class="line">12</span><br></pre></td></tr></table></figure><p>如果将文件位置改为-，表示接收标准输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> file |<span class="built_in">paste</span> testfile1 -</span></span><br><span class="line">huanggai 56     xiongdan 200</span><br><span class="line">zhixi 73        lihaihui 233</span><br><span class="line">        lymlrl 231</span><br><span class="line">1234</span><br></pre></td></tr></table></figure><h4 id="split-文件切割">split - 文件切割</h4><p>split命令用于将一个文件分割成数个。</p><p>该指令将大文件分割成较小的文件，在默认情况下将按照每1000行切割成一个小文件。</p><p>语法：</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">split [-<span class="keyword">bl] </span>file <span class="keyword">prefix</span></span><br><span class="line"><span class="keyword"></span>-<span class="keyword">b: </span>以大小切割</span><br><span class="line">-l：以行数切割</span><br><span class="line"><span class="keyword">prefix：切割后文件的前缀</span></span><br><span class="line"><span class="keyword"></span><span class="number">1234</span></span><br></pre></td></tr></table></figure><p><strong>参数说明</strong>：</p><ul class="lvl-0"><li class="lvl-2"><p>-&lt;行数&gt; : 指定每多少行切成一个小文件</p></li><li class="lvl-2"><p>-b&lt;字节&gt; : 指定每多少字节切成一个小文件</p></li><li class="lvl-2"><p>-C&lt;字节&gt; : 与参数&quot;-b&quot;相似，但是在切 割时将尽量维持每行的完整性</p></li><li class="lvl-2"><p>[输出文件名] : 设置切割后文件的前置文件名， split会自动在前置文件名后再加上编号</p></li></ul><p>使用指令&quot;split&quot;将文件&quot;README&quot;每6行切割成一个文件，输入如下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">split</span> -6 README       <span class="comment">#将README文件每六行分割成一个文件</span></span> </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span>                                <span class="comment">#执行ls指令</span></span>  </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">获得当前目录结构</span></span><br><span class="line">README xaa xad xag xab xae xah xac xaf xai</span><br><span class="line">1234</span><br></pre></td></tr></table></figure><p>以上命令执行后，指令&quot;split&quot;会将原来的大文件&quot;README&quot;切割成多个以&quot;x&quot;开头的小文件。而在这些小文件中，每个文件都只有6行内容。</p><p>以大小切割：</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ ls -<span class="keyword">lh </span><span class="keyword">disease.dmp</span></span><br><span class="line"><span class="keyword"></span>-rwxr-xr-x <span class="number">1</span> root root <span class="number">122</span>M <span class="keyword">Jul </span> <span class="number">4</span>  <span class="number">2013</span> <span class="keyword">disease.dmp</span></span><br><span class="line"><span class="keyword"></span>$ split -<span class="keyword">b </span><span class="number">50</span>m <span class="keyword">disease.dmp </span><span class="keyword">disease.dmp</span></span><br><span class="line"><span class="keyword"></span>$ ls -<span class="keyword">lh </span><span class="keyword">disease.dmp*</span></span><br><span class="line"><span class="keyword"></span>-rwxr-xr-x <span class="number">1</span> root root <span class="number">122</span>M <span class="keyword">Jul </span> <span class="number">4</span>  <span class="number">2013</span> <span class="keyword">disease.dmp</span></span><br><span class="line"><span class="keyword"></span>-rw-r--r-- <span class="number">1</span> root root  <span class="number">50</span>M <span class="keyword">Jan </span> <span class="number">9</span> <span class="number">16</span>:<span class="number">10</span> <span class="keyword">disease.dmpaa</span></span><br><span class="line"><span class="keyword"></span>-rw-r--r-- <span class="number">1</span> root root  <span class="number">50</span>M <span class="keyword">Jan </span> <span class="number">9</span> <span class="number">16</span>:<span class="number">10</span> <span class="keyword">disease.dmpab</span></span><br><span class="line"><span class="keyword"></span>-rw-r--r-- <span class="number">1</span> root root  <span class="number">22</span>M <span class="keyword">Jan </span> <span class="number">9</span> <span class="number">16</span>:<span class="number">10</span> <span class="keyword">disease.dmpac</span></span><br><span class="line"><span class="keyword"></span><span class="number">12345678</span></span><br></pre></td></tr></table></figure><h4 id="xargs-参数代换">xargs - 参数代换</h4><p>不是所有的命令都支持管道，如ls，对于不支持管道的命令，可以通过xargs让其有管道命令的效果，如下所示：</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find /sbin -perm +7000 | xargs ls -l</span></span><br><span class="line">-rwsr-x---<span class="number"> 1 </span>root ecryptfs<span class="number"> 19896 </span>Feb<span class="number"> 23 </span><span class="number"> 2012 </span>/sbin/mount.ecryptfs_private</span><br><span class="line">-rwsr-xr-x<span class="number"> 1 </span>root root    <span class="number"> 75496 </span>Jan <span class="number"> 9 </span><span class="number"> 2013 </span>/sbin/mount.nfs</span><br><span class="line">-rwsr-xr-x<span class="number"> 1 </span>root root    <span class="number"> 75504 </span>Jan <span class="number"> 9 </span><span class="number"> 2013 </span>/sbin/mount.nfs4</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root root     <span class="number"> 8544 </span>Feb<span class="number"> 22 </span><span class="number"> 2012 </span>/sbin/netreport</span><br><span class="line">-rwsr-xr-x<span class="number"> 1 </span>root root    <span class="number"> 14112 </span>Nov <span class="number"> 2 </span><span class="number"> 2010 </span>/sbin/pam_timestamp_check</span><br><span class="line">-rwsr-xr-x<span class="number"> 1 </span>root root    <span class="number"> 75504 </span>Jan <span class="number"> 9 </span><span class="number"> 2013 </span>/sbin/umount.nfs</span><br><span class="line">-rwsr-xr-x<span class="number"> 1 </span>root root    <span class="number"> 75504 </span>Jan <span class="number"> 9 </span><span class="number"> 2013 </span>/sbin/umount.nfs4</span><br><span class="line">-rwsr-xr-x<span class="number"> 1 </span>root root    <span class="number"> 19768 </span>Nov <span class="number"> 2 </span><span class="number"> 2010 </span>/sbin/unix_chkpwd</span><br><span class="line">123456789</span><br></pre></td></tr></table></figure><p>如果没有xargs，ls -l的结果将不是前面find的标准输出，因为ls不支持管道命令。</p><p>xargs 用作替换工具，读取输入数据重新格式化后输出。</p><p>定义一个测试文件，内有多行文本数据：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># cat test<span class="selector-class">.txt</span></span><br><span class="line"><span class="selector-tag">a</span> <span class="selector-tag">b</span> c d e f <span class="selector-tag">g</span></span><br><span class="line">h <span class="selector-tag">i</span> j k l m n</span><br><span class="line">o <span class="selector-tag">p</span> <span class="selector-tag">q</span></span><br><span class="line"><span class="attribute">r</span> s t</span><br><span class="line">u v w <span class="attribute">x</span> <span class="attribute">y</span> z</span><br><span class="line"><span class="number">123456</span></span><br></pre></td></tr></table></figure><p>多行输入单行输出：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># <span class="selector-tag">cat</span> <span class="selector-tag">test</span><span class="selector-class">.txt</span> | <span class="selector-tag">xargs</span></span><br><span class="line"><span class="selector-tag">a</span> <span class="selector-tag">b</span> <span class="selector-tag">c</span> <span class="selector-tag">d</span> <span class="selector-tag">e</span> <span class="selector-tag">f</span> <span class="selector-tag">g</span> <span class="selector-tag">h</span> <span class="selector-tag">i</span> <span class="selector-tag">j</span> <span class="selector-tag">k</span> <span class="selector-tag">l</span> <span class="selector-tag">m</span> <span class="selector-tag">n</span> <span class="selector-tag">o</span> <span class="selector-tag">p</span> <span class="selector-tag">q</span> <span class="selector-tag">r</span> <span class="selector-tag">s</span> <span class="selector-tag">t</span> <span class="selector-tag">u</span> <span class="selector-tag">v</span> <span class="selector-tag">w</span> <span class="selector-tag">x</span> <span class="selector-tag">y</span> <span class="selector-tag">z</span></span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure><p>-n 选项多行输出：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># <span class="selector-tag">cat</span> <span class="selector-tag">test</span><span class="selector-class">.txt</span> | <span class="selector-tag">xargs</span> <span class="selector-tag">-n3</span></span><br><span class="line"><span class="selector-tag">a</span> <span class="selector-tag">b</span> <span class="selector-tag">c</span></span><br><span class="line"><span class="selector-tag">d</span> <span class="selector-tag">e</span> <span class="selector-tag">f</span></span><br><span class="line"><span class="selector-tag">g</span> <span class="selector-tag">h</span> <span class="selector-tag">i</span></span><br><span class="line"><span class="selector-tag">j</span> <span class="selector-tag">k</span> <span class="selector-tag">l</span></span><br><span class="line"><span class="selector-tag">m</span> <span class="selector-tag">n</span> <span class="selector-tag">o</span></span><br><span class="line"><span class="selector-tag">p</span> <span class="selector-tag">q</span> <span class="selector-tag">r</span></span><br><span class="line"><span class="selector-tag">s</span> <span class="selector-tag">t</span> <span class="selector-tag">u</span></span><br><span class="line"><span class="selector-tag">v</span> <span class="selector-tag">w</span> <span class="selector-tag">x</span></span><br><span class="line"><span class="selector-tag">y</span> <span class="selector-tag">z</span></span><br><span class="line"><span class="number">12345678910</span></span><br></pre></td></tr></table></figure><p>-d 选项可以自定义一个定界符：</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># echo <span class="string">&quot;nameXnameXnameXname&quot;</span> | xargs -dX</span></span><br><span class="line"><span class="built_in">name</span> <span class="built_in">name</span> <span class="built_in">name</span> <span class="built_in">name</span></span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure><p>结合 -n 选项使用：</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># echo <span class="string">&quot;nameXnameXnameXname&quot;</span> | xargs -dX -n2</span></span><br><span class="line"><span class="built_in">name</span> <span class="built_in">name</span></span><br><span class="line"><span class="built_in">name</span> <span class="built_in">name</span></span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></table></figure><p>读取 stdin，将格式化后的参数传递给命令:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> sk.sh</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sk.sh命令内容，打印出所有参数。</span></span><br><span class="line">echo $*</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> arg.txt</span></span><br><span class="line">aaa</span><br><span class="line">bbb</span><br><span class="line">ccc</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> arg.txt | xargs -I &#123;&#125; ./sk.sh -p &#123;&#125; -l</span></span><br><span class="line">-p aaa -l</span><br><span class="line">-p bbb -l</span><br><span class="line">-p ccc -l</span><br><span class="line">123456789101112</span><br></pre></td></tr></table></figure><p>选项<code>-I</code>指定一个替换字符串 {}，这个字符串在 xargs 扩展时会被替换掉。</p><p>复制所有图片文件到 /data/images 目录下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> *.jpg | xargs -n1 -I &#123;&#125; <span class="built_in">cp</span> &#123;&#125; /data/images</span><br><span class="line">1</span><br></pre></td></tr></table></figure><p>选项<code>-n</code> 后面加次数，表示命令在执行的时候一次用的argument的个数，默认是用所有的。</p><p><strong>xargs 结合 find 使用</strong></p><p>用 rm 删除太多的文件时候，可能得到一个错误信息：<strong>/bin/rm Argument list too long.</strong> 用 xargs 去避免这个问题：</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find . -<span class="keyword">type</span> <span class="type">f </span>-name <span class="string">&quot;*.log&quot;</span> -print0 | xargs -<span class="number">0</span> rm -f</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p>xargs -0 将 \0 作为定界符。</p><p>统计一个源代码目录中所有 php 文件的行数：</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find . -<span class="keyword">type</span> <span class="type">f </span>-name <span class="string">&quot;*.php&quot;</span> -print0 | xargs -<span class="number">0</span> wc -l</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p>查找所有的 jpg 文件，并且压缩它们：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> . -type f -name <span class="string">&quot;*.jpg&quot;</span> -<span class="built_in">print</span> | xargs tar -czvf images.tar.gz</span><br><span class="line">1</span><br></pre></td></tr></table></figure><p>批量下载：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> url-list.txt | xargs wget -c</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure><p>wget的<code>-c</code>选项表示断点续传。</p><h2 id="文本编辑命令">文本编辑命令</h2><h3 id="cut命令">cut命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">选项与参数：</span><br><span class="line">-d  ：后面接分隔字符。与 -f 一起使用；</span><br><span class="line">-f  ：依据 -d 的分隔字符将一段信息分割成为数段，用 -f 取出第几段的意思；</span><br><span class="line">-c  ：以字符 (characters) 的单位取出固定字符区间；</span><br></pre></td></tr></table></figure><p>cut以行为单位，根据分隔符把行分成若干列，这样就可以指定选取哪些列了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cut</span> -d <span class="string">&#x27;分隔字符&#x27;</span> -f 选取的列数</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span>|<span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f 2  	--选取第2列</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span>|<span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f 3,5  	--选取第3列和第5列</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span>|<span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f 3-5  	--选取第3列到第5列</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span>|<span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f 3-   	--选取第3列到最后1列</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span>|<span class="built_in">cut</span> -d <span class="string">&#x27;:&#x27;</span> -f 1-3,5	--选取第1到第3列还有第5列</span><br></pre></td></tr></table></figure><p>只显示/etc/passwd的用户和shell：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#cat /etc/passwd | cut -d &#x27;:&#x27; -f 1,7 </span></span><br><span class="line">root:/bin/bash</span><br><span class="line">daemon:/bin/sh</span><br><span class="line">bin:/bin/sh</span><br></pre></td></tr></table></figure><h3 id="sed命令">sed命令</h3><p>sed 可依照脚本的指令来处理、编辑文本文件。</p><p>Sed 主要用来自动编辑一个或多个文件、简化对文件的反复操作、编写转换程序等。</p><p>语法:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed [-e&lt;script&gt;][-f&lt;script文件&gt;][文本文件]</span><br></pre></td></tr></table></figure><p><strong>参数说明</strong>：</p><ul class="lvl-0"><li class="lvl-2"><p><code>-e &lt;script&gt;</code>以指定的script来处理输入的文本文件。</p></li><li class="lvl-2"><p><code>-f&lt;script文件&gt;</code>以指定的script文件来处理输入的文本文件。</p></li><li class="lvl-2"><p><code>-n</code>仅显示script处理后的结果，一般跟p动作搭配使用。</p></li><li class="lvl-2"><p><code>-i</code>使用处理后的结果修改文件。</p></li></ul><p><strong>动作说明</strong>：</p><ul class="lvl-0"><li class="lvl-2"><p>a：在指定行后面插入内容</p></li><li class="lvl-2"><p>i：在指定行前面插入内容</p></li><li class="lvl-2"><p>d：删除指定行</p></li><li class="lvl-2"><p>c ：替换指定行</p></li><li class="lvl-2"><p>p ：打印指定行的数据，通常需要跟<code>-n</code>选项搭配使用</p></li><li class="lvl-2"><p>s ：替换指定字符，兼容vim的替换语法，例如 1,20s/old/new/g</p></li></ul><h4 id="元字符集">元字符集</h4><p>sed支持一般的正则表达式，下面是支持的正则语法：<code>^</code>行的开始 如：/^sed/匹配所有以sed开头的行。<code>$</code>行的结束 如：/sed$/匹配所有以sed结尾的行。<code>.</code>匹配一个非换行符的任意字符 如：/s.d/匹配s后接一个任意字符，然后是d。<code>*</code>匹配零或多个字符 如：/*sed/匹配所有模板是一个或多个空格后紧跟sed的行。<code>[]</code>匹配一个指定范围内的字符，如<code>/[Ss]ed/</code>匹配sed和Sed。<code>[^]</code>匹配一个不在指定范围内的字符，如：<code>/[^A-RT-Z]ed/</code>匹配不包含A-R和T-Z的一个字母开头，紧跟ed的行。<code>\(..\)</code>保存匹配的字符，如s/(love)able/\1rs，loveable被替换成lovers。<code>&amp;</code>保存搜索字符用来替换其他字符，如<code>s/love/**&amp;**/</code>，love这成<code>**love**</code>。<code>\&lt;</code>单词的开始，如:/&lt;love/匹配包含以love开头的单词的行。<code>\&gt;</code>单词的结束，如/love&gt;/匹配包含以love结尾的单词的行。<code>x\+</code>重复字符x，至少1次，如：<code>/o\+/</code>匹配至少有1个o的行。<code>x\&#123;m\&#125;</code>重复字符x，m次，如：<code>/o\&#123;5\&#125;/</code>匹配包含5个o的行。<code>x\&#123;m,\&#125;</code>重复字符x,至少m次，如：<code>/o\&#123;5,\&#125;/</code>匹配至少有5个o的行。<code>x\&#123;m,n\&#125;</code>重复字符x，至少m次，不多于n次，如：<code>/o\&#123;5,10\&#125;/</code>匹配5-10个o的行。</p><h4 id="a-i-在指定行位置添加行">a|i:在指定行位置添加行</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:Corazon]# <span class="built_in">cat</span> a</span><br><span class="line">LINUX!  </span><br><span class="line"> Linux is a free unix-type opterating system.  </span><br><span class="line"> This is a linux testfile!  </span><br><span class="line"> Linux <span class="built_in">test</span> </span><br><span class="line"></span><br><span class="line">[root@rocky8:Corazon]# sed -e 2a\newline a</span><br><span class="line">LINUX!  </span><br><span class="line"> Linux is a free unix-type opterating system.  </span><br><span class="line">newline</span><br><span class="line"> This is a linux testfile!  </span><br><span class="line"> Linux <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>默认情况下<code>-e</code>参数可以省略：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:Corazon]# <span class="built_in">cat</span> a | sed <span class="string">&#x27;2a\newline&#x27;</span></span><br><span class="line">LINUX!  </span><br><span class="line"> Linux is a free unix-type opterating system.  </span><br><span class="line">newline</span><br><span class="line"> This is a linux testfile!  </span><br><span class="line"> Linux <span class="built_in">test</span> </span><br><span class="line">[root@rocky8:~]# sed 2a\newline a</span><br><span class="line">NUX!  </span><br><span class="line"> Linux is a free unix-type opterating system.  </span><br><span class="line">newline</span><br><span class="line"> This is a linux testfile!  </span><br><span class="line"> Linux <span class="built_in">test</span></span><br><span class="line">[root@rocky8:Corazon]# sed <span class="string">&#x27;2a newline&#x27;</span> a</span><br><span class="line">LINUX!  </span><br><span class="line"> Linux is a free unix-type opterating system.  </span><br><span class="line">newline</span><br><span class="line"> This is a linux testfile!  </span><br><span class="line"> Linux <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>在第二行之前添加一行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:Corazon]# sed <span class="string">&#x27;2i newline&#x27;</span> a</span><br><span class="line">LINUX!  </span><br><span class="line">newline</span><br><span class="line"> Linux is a free unix-type opterating system.  </span><br><span class="line"> This is a linux testfile!  </span><br><span class="line"> Linux <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>最后一行加入 <code># This is a test</code>:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:Corazon]# sed <span class="string">&#x27;$a # This is a test&#x27;</span> a</span><br><span class="line">LINUX!  </span><br><span class="line"> Linux is a free unix-type opterating system.  </span><br><span class="line"> This is a linux testfile!  </span><br><span class="line"> Linux <span class="built_in">test</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># This is a test</span></span><br></pre></td></tr></table></figure><p>同时添加多行：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:Corazon]# cat a|sed <span class="string">&#x27;2a\newline1\</span></span><br><span class="line"><span class="string">&gt; newline2&#x27;</span></span><br><span class="line">LINUX!  </span><br><span class="line"> Linux <span class="keyword">is</span> a free unix-<span class="keyword">type</span> opterating <span class="keyword">system</span>.  </span><br><span class="line">newline1</span><br><span class="line">newline2</span><br><span class="line"> This <span class="keyword">is</span> a linux testfile!  </span><br><span class="line"> Linux test</span><br></pre></td></tr></table></figure><h4 id="d-删除指定行">d:删除指定行</h4><p>将 /etc/passwd 的内容列出行号，并将第 2~5 行删除！</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">nl</span> /etc/passwd|sed <span class="string">&#x27;2,5d&#x27;</span></span><br><span class="line">     1	root:x:0:0:root:/root:/bin/bash</span><br><span class="line">     6	<span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">     7	shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">.....(后面省略).....</span><br></pre></td></tr></table></figure><p>只删除第2行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nl</span> /etc/passwd | sed <span class="string">&#x27;2d&#x27;</span> </span><br></pre></td></tr></table></figure><p>删除第3到最后一行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nl</span> /etc/passwd | sed <span class="string">&#x27;3,$d&#x27;</span> </span><br></pre></td></tr></table></figure><p>删除/etc/passwd所有包含<code>/sbin/nologin</code>的行，其他行输出：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">nl</span> /etc/passwd|sed <span class="string">&#x27;/\/sbin\/nologin/d&#x27;</span></span><br><span class="line">     1	root:x:0:0:root:/root:/bin/bash</span><br><span class="line">     6	<span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">     7	shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">     8	halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">    25	zah:x:1000:1000:Zah:/home/zah:/bin/bash</span><br><span class="line">    26	Cora:x:1002:1002::/home/Cora:/bin/bash</span><br><span class="line">    27	Corazon:x:1003:1003::/home/Corazon:/bin/bash</span><br></pre></td></tr></table></figure><h4 id="c-替换指定行">c:替换指定行</h4><p>将第2-5行的内容替换成为『No 2-5 number』：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">nl</span> /etc/passwd|sed <span class="string">&#x27;2,5c No 2-5 number&#x27;</span></span><br><span class="line">     1	root:x:0:0:root:/root:/bin/bash</span><br><span class="line">No 2-5 number</span><br><span class="line">     6	<span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br></pre></td></tr></table></figure><h4 id="p-仅显示指定行">p:仅显示指定行</h4><p>不加<code>-n</code>选项时，除了输出匹配行，还同时会输出所有行，所以需要加<code>-n</code>选项。</p><p>仅列出 /etc/passwd 文件内的第 5-7 行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">nl</span> /etc/passwd|sed -n <span class="string">&#x27;5,7p&#x27;</span></span><br><span class="line">     5	lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">     6	<span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">     7	shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br></pre></td></tr></table></figure><p>搜索 /etc/passwd有root关键字的行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> /etc/passwd|sed -n <span class="string">&#x27;/root/p&#x27;</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">[root@rocky8:~]# sed -n <span class="string">&#x27;/root/p&#x27;</span> /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">operator:x:11:0:operator:/root:/sbin/nologin</span><br></pre></td></tr></table></figure><p>打印/etc/passwd有以root和bin开头之间的行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# sed -n <span class="string">&#x27;/^root/,/^bin/p&#x27;</span> /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br></pre></td></tr></table></figure><p>打印从第五行开始到第一个包含以<code>/usr/games</code>开始的行之间的所有行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">nl</span> /etc/passwd | sed -n <span class="string">&#x27;5,\/usr\/games/p&#x27;</span></span><br><span class="line">     5	lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">     6	<span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">     7	shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">     8	halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">     9	mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">    10	operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">    11	games:x:12:100:games:/usr/games:/sbin/nologin</span><br></pre></td></tr></table></figure><h4 id="s-字符串替换">s:字符串替换</h4><p>语法：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sed</span> <span class="string">&#x27;s/要被取代的字串/新的字串/g&#x27;</span></span><br></pre></td></tr></table></figure><p>不论什么字符，紧跟着s命令的都被认为是新的分隔符.</p><p><code>sed 's#10#100#g'</code>表示把所有10替换成100，“#”在这里是分隔符，代替了默认的“/”分隔符。</p><p>提取本机所有的ip地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# ifconfig | grep <span class="string">&#x27;inet &#x27;</span></span><br><span class="line">        inet 10.0.0.191  netmask 255.255.255.0  broadcast 10.0.0.255</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">[root@rocky8:~]# ifconfig | grep <span class="string">&#x27;inet &#x27;</span>|sed <span class="string">&#x27;s/^[^0-9]*\([0-9\.]*\).*$/\1/g&#x27;</span></span><br><span class="line">10.0.0.191</span><br><span class="line">127.0.0.1</span><br></pre></td></tr></table></figure><p>对于以root和bin开头之间的行，每行的末尾添加sed test：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> /etc/passwd | sed <span class="string">&#x27;/^root/,/^bin/s/$/--sed test/&#x27;</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash--sed <span class="built_in">test</span></span><br><span class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin--sed <span class="built_in">test</span></span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin--sed <span class="built_in">test</span></span><br><span class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">......</span><br></pre></td></tr></table></figure><h4 id="y-单字符替换">y:单字符替换</h4><p>跟s一样也用于替换，不过s替换的是整体，y替换的是每一字母对应的单个字母</p><p>把data中的第一行至第三行中的a替换成A，b替换成B，c替换成C：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;1,3y/abc/ABC/&#x27;</span> data </span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">echo</span> <span class="string">&quot;123&quot;</span> | sed <span class="string">&#x27;y/13/34/&#x27;</span></span><br><span class="line">324</span><br><span class="line">[root@rocky8:~]# <span class="built_in">echo</span> <span class="string">&quot;axxbxxcxx&quot;</span> | sed <span class="string">&#x27;y/abc/123/&#x27;</span></span><br><span class="line">1xx2xx3xx</span><br></pre></td></tr></table></figure><p><font class="notice">注：单个字符转换用y，字符串转换用<code>'s/str1/str2/g'</code></font></p><h4 id="hHgG模式空间与保持空间"><code>hHgG</code>模式空间与保持空间</h4><p>首先介绍一下模式空间和保持空间:</p><blockquote><p><strong>（H、h、G、g、x）</strong><br><strong>模式空间：</strong><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=sed&amp;spm=1001.2101.3001.7020">sed</a>处理文本内容行的一个临时缓冲区，模式空间中的内容会主动打印到标准输出，并自动清空模式空间</p><p>**保持空间：**sed处理文本内容行的另一个临时缓冲区，不同的是保持空间内容不会主动清空，也不会主动打印到标准输出，而是需要<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=sed%E5%91%BD%E4%BB%A4&amp;spm=1001.2101.3001.7020">sed命令</a>来进行处理</p></blockquote><p>模式空间与保持空间的关系:</p><blockquote><p>**模式空间：**相当于流水线，文本行再模式空间中进行处理；<br>**保持空间：**相当于仓库，在模式空间对数据进行处理时，可以把数据临时存储到保持空间；作为模式空间的一个辅助临时缓冲区，但又是相互独立，可以进行交互，命令可以寻址模式空间但是不能寻址保持空间。可以使用高级命令h,H,g,G与模式空间进行交互。</p></blockquote><p>实际上， 保持空间是模式空间一个临时存放数据的缓冲区，协助模式空间进行数据处理。</p><p>相关命令的作用：</p><blockquote><p><strong>d</strong> Delete pattern space. Start next cycle.<br>删除pattern space的内容，开始下一个循环</p><p><strong>h H</strong> Copy/append pattern space to hold space.<br>复制/追加pattern space的内容到hold space.（复制会覆盖原内容）</p><p><strong>g G</strong> Copy/append hold space to pattern space.<br>复制/追加hold space的内容到pattern space. （复制会覆盖原内容）</p><p><strong>x</strong> Exchange the contents of the hold and pattern spaces.<br>交换hold space和pattern space的内容.</p></blockquote><p>h命令是将当前模式空间中内容覆盖至保持空间，H命令是将当前模式空间中的内容追加至保持空间</p><p>g命令是将当前保持空间中内容覆盖至模式空间，G命令是将当前保持空间中的内容追加至模式空间</p><p>模拟tac命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> num</span><br><span class="line">One</span><br><span class="line">Two</span><br><span class="line">Three</span><br><span class="line">[root@rocky8:~]# <span class="built_in">tac</span> num</span><br><span class="line">Three</span><br><span class="line">Two</span><br><span class="line">One</span><br><span class="line">[root@rocky8:~]# sed <span class="string">&#x27;1!G;h;$!d&#x27;</span> num</span><br><span class="line">Three</span><br><span class="line">Two</span><br><span class="line">One</span><br></pre></td></tr></table></figure><p>1!G第1行不 执行“G”命令，从第2行开始执行。</p><p>$!d，最后一行不删除（保留最后1行）（只有最后一行不删）</p><p>原理图：</p><p><img src="/images/loading.jpeg" data-original="/posts/247a4e5f//image-20250219211455837.png" alt="image-20250219211455837"></p><p>递增序列：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@rocky8</span>:~]<span class="meta"># seq 3|sed <span class="string">&#x27;H;g&#x27;</span></span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line">[root<span class="symbol">@rocky8</span>:~]<span class="meta"># seq 3|sed <span class="string">&#x27;1h;1!H;g&#x27;</span></span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure><h4 id="多次指定-e选项进行多点编辑">多次指定<code>-e</code>选项进行多点编辑</h4><p>删除/etc/passwd第三行到末尾的数据，并把bash替换为blueshell：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">nl</span> /etc/passwd | sed -e <span class="string">&#x27;3,$d&#x27;</span> -e <span class="string">&#x27;s/bash/blueshell/&#x27;</span></span><br><span class="line">     1	root:x:0:0:root:/root:/bin/blueshell</span><br><span class="line">     2	daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br></pre></td></tr></table></figure><p>删除一个文件以#开头的行和空行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> abc</span><br><span class="line"></span><br><span class="line">b</span><br><span class="line">a</span><br><span class="line"></span><br><span class="line"><span class="comment"># aaa</span></span><br><span class="line"></span><br><span class="line">ddd</span><br><span class="line"></span><br><span class="line"><span class="comment"># sss</span></span><br><span class="line">eeee</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@rocky8:~]# sed -e <span class="string">&#x27;/^#/d&#x27;</span> -e <span class="string">&#x27;/^$/d&#x27;</span> abc</span><br><span class="line">b</span><br><span class="line">a</span><br><span class="line">ddd</span><br><span class="line">eeee</span><br></pre></td></tr></table></figure><p>也可以通过<code>;</code>实现</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">nl</span> /etc/passwd|sed <span class="string">&#x27;3,$d;s/bash/blueshell/&#x27;</span> </span><br><span class="line">     1	root:x:0:0:root:/root:/bin/blueshell</span><br><span class="line">     2	daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">[root@rocky8:~]# sed <span class="string">&#x27;/^#/d;/^$/d&#x27;</span> abc</span><br><span class="line">b</span><br><span class="line">a</span><br><span class="line">ddd</span><br><span class="line">eeee</span><br></pre></td></tr></table></figure><h4 id="选项-i直接修改文件内容">选项<code>-i</code>直接修改文件内容</h4><p>默认情况下sed命令仅仅只是将处理结果显示在控制台，加<code>-i</code>选项则会修改文件内容。</p><p>将 regular_express.txt 内每一行结尾若为 . 则换成 !</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> re</span><br><span class="line">taobao.</span><br><span class="line">google.</span><br><span class="line">taobao.</span><br><span class="line">facebook.</span><br><span class="line">zhihu-</span><br><span class="line">weibo-</span><br><span class="line">[root@rocky8:~]# sed -i <span class="string">&#x27;s/\.$/\!/&#x27;</span> re</span><br><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> re</span><br><span class="line">taobao!</span><br><span class="line">google!</span><br><span class="line">taobao!</span><br><span class="line">facebook!</span><br><span class="line">zhihu-</span><br><span class="line">weibo-</span><br></pre></td></tr></table></figure><h3 id="awk命令">awk命令</h3><p>AWK是一种处理文本文件的语言，是一个强大的文本分析工具。</p><p>之所以叫AWK是因为其取了三位创始人 Alfred Aho，Peter Weinberger, 和 Brian Kernighan 的 Family Name 的首字符。</p><p>语法：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">awk [选项参数] <span class="string">&#x27;script&#x27;</span> var=value file(s)</span><br><span class="line">或</span><br><span class="line">awk [选项参数] -f scriptfile var=value file(s)</span><br></pre></td></tr></table></figure><p><strong>选项参数说明：</strong></p><ul class="lvl-0"><li class="lvl-2"><p>-F fs or --field-separator fs<br>指定输入文件折分隔符，fs是一个字符串或者是一个正则表达式，如-F:。</p></li><li class="lvl-2"><p>-v var=value or --asign var=value<br>赋值一个用户定义变量。</p></li><li class="lvl-2"><p>-f scripfile or --file scriptfile<br>从脚本文件中读取awk命令。</p></li></ul><h4 id="基本用法">基本用法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;[pattern] action&#125;&#x27;</span> file</span><br></pre></td></tr></table></figure><p>每行按空格或TAB分割，使用<code>print</code>输出文本中的1、4列：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> <span class="built_in">log</span></span><br><span class="line">2 this is a <span class="built_in">test</span></span><br><span class="line">3 Are you like awk</span><br><span class="line">This<span class="string">&#x27;s a test</span></span><br><span class="line"><span class="string">10 There are orange,apple,mongo</span></span><br><span class="line"><span class="string">[root@rocky8:~]# awk &#x27;</span>&#123;<span class="built_in">print</span> <span class="variable">$1</span>,<span class="variable">$4</span>&#125;<span class="string">&#x27; log</span></span><br><span class="line"><span class="string">2 a</span></span><br><span class="line"><span class="string">3 like</span></span><br><span class="line"><span class="string">This&#x27;</span>s </span><br><span class="line">10 orange,apple,mongo</span><br></pre></td></tr></table></figure><p>使用<code>printf</code>格式化输出：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;&#123;printf &quot;%-8s %-10s\n&quot;,$1,$4&#125;&#x27;</span> <span class="built_in">log</span></span><br><span class="line">2        a         </span><br><span class="line">3        like      </span><br><span class="line">This<span class="string">&#x27;s             </span></span><br><span class="line"><span class="string">10       orange,apple,mongo</span></span><br></pre></td></tr></table></figure><h5 id="F指定分割字符"><code>-F</code>指定分割字符</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F  <span class="comment">#-F相当于内置变量FS, 指定分割字</span></span><br></pre></td></tr></table></figure><p>使用:分割,取/etc/passwd文件每个用户对应shell：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk -F: <span class="string">&#x27;&#123;print $1,$7&#125;&#x27;</span> /etc/passwd</span><br><span class="line">root /bin/bash</span><br><span class="line">daemon /sbin/nologin</span><br><span class="line">bin /sbin/nologin</span><br><span class="line">adm /sbin/nologin</span><br><span class="line">lp /sbin/nologin</span><br><span class="line"><span class="built_in">sync</span> /bin/sync</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>同时使用:和/l两个分隔符分割/etc/passwd文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk -F <span class="string">&#x27;[:\/]&#x27;</span> <span class="string">&#x27;&#123;print $1,$7&#125;&#x27;</span>  /etc/passwd</span><br><span class="line">awk: warning: escape sequence `\/<span class="string">&#x27; treated as plain `/&#x27;</span></span><br><span class="line">root root</span><br><span class="line">daemon sbin</span><br><span class="line">bin bin</span><br><span class="line">......</span><br></pre></td></tr></table></figure><h5 id="v设置变量"><code>-v</code>设置变量</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -v  <span class="comment"># 设置变量</span></span><br></pre></td></tr></table></figure><p>例子：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> <span class="built_in">log</span></span><br><span class="line">2 this is a <span class="built_in">test</span></span><br><span class="line">3 Are you like awk</span><br><span class="line">This<span class="string">&#x27;s a test</span></span><br><span class="line"><span class="string">10 There are orange,apple,mongo</span></span><br><span class="line"><span class="string">[root@rocky8:~]# awk -va=1 &#x27;</span>&#123;<span class="built_in">print</span> <span class="variable">$1</span>,<span class="variable">$1</span>+a&#125;<span class="string">&#x27; log</span></span><br><span class="line"><span class="string">2 3</span></span><br><span class="line"><span class="string">3 4</span></span><br><span class="line"><span class="string">This&#x27;</span>s 1</span><br><span class="line">10 11</span><br><span class="line">[root@rocky8:~]# awk -va=1 -vb=s <span class="string">&#x27;&#123;print $1,$1+a,$1b&#125;&#x27;</span> <span class="built_in">log</span></span><br><span class="line">2 3 2s</span><br><span class="line">3 4 3s</span><br><span class="line">This<span class="string">&#x27;s 1 This&#x27;</span>ss</span><br><span class="line">10 11 10s</span><br></pre></td></tr></table></figure><h5 id="f指定awk脚本"><code>-f</code>指定awk脚本</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -f &#123;awk脚本&#125; &#123;文件名&#125;</span><br></pre></td></tr></table></figure><p>脚本模块：</p><ul class="lvl-0"><li class="lvl-2"><p>BEGIN{ 这里面放的是执行前的语句 }</p></li><li class="lvl-2"><p>END {这里面放的是处理完所有的行后要执行的语句 }</p></li><li class="lvl-2"><p>{这里面放的是处理每一行时要执行的语句}</p></li></ul><p>假设有这么一个文件（学生成绩表）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> score</span><br><span class="line">Marry   2143 78 84 77</span><br><span class="line">Jack    2321 66 78 45</span><br><span class="line">Tom     2122 48 77 71</span><br><span class="line">Mike    2537 87 97 95</span><br><span class="line">Bob     2415 40 57 62</span><br></pre></td></tr></table></figure><p>awk脚本如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> cal.awk</span><br><span class="line"><span class="comment">#!/bin/awk -f</span></span><br><span class="line"><span class="comment">#运行前</span></span><br><span class="line">BEGIN &#123;</span><br><span class="line">    math = 0</span><br><span class="line">    english = 0</span><br><span class="line">    computer = 0</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;NAME    NO.   MATH  ENGLISH  COMPUTER   TOTAL\n&quot;</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;---------------------------------------------\n&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#运行中</span></span><br><span class="line">&#123;</span><br><span class="line">    math+=<span class="variable">$3</span></span><br><span class="line">    english+=<span class="variable">$4</span></span><br><span class="line">    computer+=<span class="variable">$5</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;%-6s %-6s %4d %8d %8d %8d\n&quot;</span>, <span class="variable">$1</span>,<span class="variable">$2</span>,<span class="variable">$3</span>,<span class="variable">$4</span>,<span class="variable">$5</span>,<span class="variable">$3</span>+<span class="variable">$4</span>+<span class="variable">$5</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#运行后</span></span><br><span class="line">END &#123;</span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;---------------------------------------------\n&quot;</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;  TOTAL:%10d %8d %8d \n&quot;</span>, math, english, computer</span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;AVERAGE:%10.2f %8.2f %8.2f\n&quot;</span>, math/NR, english/NR, computer/NR</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font class="notice">注：END{}中的NR表示已经读出的记录数，就是行号，从1开始</font></p><p>我们来看一下执行结果：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk -f cal.awk score</span><br><span class="line">NAME    NO.   MATH  ENGLISH  COMPUTER   TOTAL</span><br><span class="line">---------------------------------------------</span><br><span class="line">Marry  2143     78       84       77      239</span><br><span class="line">Jack   2321     66       78       45      189</span><br><span class="line">Tom    2122     48       77       71      196</span><br><span class="line">Mike   2537     87       97       95      279</span><br><span class="line">Bob    2415     40       57       62      159</span><br><span class="line">---------------------------------------------</span><br><span class="line">  TOTAL:       319      393      350 </span><br><span class="line">AVERAGE:     63.80    78.60    70.00</span><br></pre></td></tr></table></figure><h4 id="AWK工作原理">AWK工作原理</h4><p>AWK 工作流程可分为三个部分：</p><ul class="lvl-0"><li class="lvl-2"><p>读输入文件之前执行的代码段（由BEGIN关键字标识）。</p></li><li class="lvl-2"><p>主循环执行输入文件的代码段。</p></li><li class="lvl-2"><p>读输入文件之后的代码段（由END关键字标识）。</p></li></ul><p>命令结构:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;BEGIN&#123; commands &#125; pattern&#123; commands &#125; END&#123; commands &#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>下面的流程图描述出了 AWK 的工作流程：</p><p><img src="/images/loading.jpeg" data-original="/posts/247a4e5f//d45d394db034998c8059e647e321a13d.png" alt="img"></p><ul class="lvl-0"><li class="lvl-2"><p>1、通过关键字 BEGIN 执行 BEGIN 块的内容，即 BEGIN 后花括号 <strong>{}</strong> 的内容。</p></li><li class="lvl-2"><p>2、完成 BEGIN 块的执行，开始执行body块。</p></li><li class="lvl-2"><p>3、读入有 <strong>\n</strong> 换行符分割的记录。</p></li><li class="lvl-2"><p>4、将记录按指定的域分隔符划分域，填充域，<strong>$0</strong> 则表示所有域(即一行内容)，**1表示第一个域，∗∗n表示第 n 个域。</p></li><li class="lvl-2"><p>5、依次执行各 BODY 块，pattern 部分匹配该行内容成功后，才会执行 awk-commands 的内容。</p></li><li class="lvl-2"><p>6、循环读取并执行各行直到文件结束，完成body块执行。</p></li><li class="lvl-2"><p>7、开始 END 块执行，END 块可以输出最终结果。</p></li></ul><h5 id="运算符">运算符</h5><table><thead><tr><th>运算符</th><th>描述</th></tr></thead><tbody><tr><td>= += -= *= /= %= ^= **=</td><td>赋值</td></tr><tr><td>?:</td><td>C条件表达式</td></tr><tr><td>||</td><td>逻辑或</td></tr><tr><td>&amp;&amp;</td><td>逻辑与</td></tr><tr><td>~ 和 !~</td><td>匹配正则表达式和不匹配正则表达式</td></tr><tr><td>&lt; &lt;= &gt; &gt;= != ==</td><td>关系运算符</td></tr><tr><td>空格</td><td>连接</td></tr><tr><td>+ -</td><td>加，减</td></tr><tr><td>* / %</td><td>乘，除与求余</td></tr><tr><td>+ - !</td><td>一元加，减和逻辑非</td></tr><tr><td>^ ***</td><td>求幂</td></tr><tr><td>++ –</td><td>增加或减少，作为前缀或后缀</td></tr><tr><td>$</td><td>字段引用</td></tr><tr><td>in</td><td>数组成员</td></tr></tbody></table><p><strong>过滤第一列大于2的行</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;$1&gt;2&#x27;</span> <span class="built_in">log</span></span><br><span class="line">3 Are you like awk</span><br><span class="line">This<span class="string">&#x27;s a test</span></span><br><span class="line"><span class="string">10 There are orange,apple,mongo</span></span><br></pre></td></tr></table></figure><p><strong>过滤第一列等于2的行</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;$1==2 &#123;print $1,$3&#125;&#x27;</span> <span class="built_in">log</span> </span><br><span class="line">2 is</span><br></pre></td></tr></table></figure><p><strong>过滤第一列大于2并且第二列等于’Are’的行</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;$1&gt;2 &amp;&amp; $2==&quot;Are&quot; &#123;print $1,$2,$3&#125;&#x27;</span> <span class="built_in">log</span></span><br><span class="line">3 Are you</span><br></pre></td></tr></table></figure><p><strong>内建变量</strong></p><table><thead><tr><th>变量</th><th>描述</th></tr></thead><tbody><tr><td>$n</td><td>当前记录的第n个字段，字段间由FS分隔</td></tr><tr><td>$0</td><td>完整的输入记录</td></tr><tr><td>ARGC</td><td>命令行参数的数目</td></tr><tr><td>ARGIND</td><td>命令行中当前文件的位置(从0开始算)</td></tr><tr><td>ARGV</td><td>包含命令行参数的数组</td></tr><tr><td>CONVFMT</td><td>数字转换格式(默认值为%.6g)ENVIRON环境变量关联数组</td></tr><tr><td>ERRNO</td><td>最后一个系统错误的描述</td></tr><tr><td>FIELDWIDTHS</td><td>字段宽度列表(用空格键分隔)</td></tr><tr><td>FILENAME</td><td>当前文件名</td></tr><tr><td>FNR</td><td>各文件分别计数的行号</td></tr><tr><td>FS</td><td>字段分隔符(默认是任何空格)</td></tr><tr><td>IGNORECASE</td><td>如果为真，则进行忽略大小写的匹配</td></tr><tr><td>NF</td><td>一条记录的字段的数目</td></tr><tr><td>NR</td><td>已经读出的记录数，就是行号，从1开始</td></tr><tr><td>OFMT</td><td>数字的输出格式(默认值是%.6g)</td></tr><tr><td>OFS</td><td>输出记录分隔符（输出换行符），输出时用指定的符号代替换行符</td></tr><tr><td>ORS</td><td>输出记录分隔符(默认值是一个换行符)</td></tr><tr><td>RLENGTH</td><td>由match函数所匹配的字符串的长度</td></tr><tr><td>RS</td><td>记录分隔符(默认是一个换行符)</td></tr><tr><td>RSTART</td><td>由match函数所匹配的字符串的第一个位置</td></tr><tr><td>SUBSEP</td><td>数组下标分隔符(默认值是/034)</td></tr></tbody></table><p>格式化变量说明：</p><ul class="lvl-0"><li class="lvl-2"><p>%s 输出字符串</p></li><li class="lvl-2"><p>%i 输出整数</p></li><li class="lvl-2"><p>%f 输出浮点数</p></li></ul><p>%-5s 格式为左对齐且宽度为5的字符串代替（-表示左对齐），不使用则是又对齐。<br>%-4.2f 格式为左对齐宽度为4，保留两位小数。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN&#123;printf &quot;%8s %8s %8s %8s %8s %8s %8s\n&quot;,&quot;FILENAME&quot;,&quot;ARGC&quot;,&quot;FNR&quot;,&quot;FS&quot;,&quot;NF&quot;,&quot;NR&quot;,&quot;OFS&quot;;printf &quot;---------------------------------------------\n&quot;&#125; &#123;printf &quot;%8s %8s %8s %8s %8s %8s %8s\n&quot;,FILENAME,ARGC,FNR,FS,NF,NR,OFS&#125;&#x27;</span>  <span class="built_in">log</span></span><br><span class="line">FILENAME     ARGC      FNR       FS       NF       NR      OFS</span><br><span class="line">---------------------------------------------</span><br><span class="line">     <span class="built_in">log</span>        2        1                 5        1         </span><br><span class="line">     <span class="built_in">log</span>        2        2                 5        2         </span><br><span class="line">     <span class="built_in">log</span>        2        3                 3        3         </span><br><span class="line">     <span class="built_in">log</span>        2        4                 4        4          </span><br><span class="line"></span><br><span class="line">[root@rocky8:~]# awk -F: <span class="string">&#x27;BEGIN&#123;printf &quot;%4s %4s %4s %4s %4s %4s %4s %4s %4s\n&quot;,&quot;FILENAME&quot;,&quot;ARGC&quot;,&quot;FNR&quot;,&quot;FS&quot;,&quot;NF&quot;,&quot;NR&quot;,&quot;OFS&quot;,&quot;ORS&quot;,&quot;RS&quot;;printf &quot;---------------------------------------------\n&quot;&#125; &#123;printf &quot;%4s %4s %4s %4s %4s %4s %4s %4s %4s\n&quot;,FILENAME,ARGC,FNR,FS,NF,NR,OFS,ORS,RS&#125;&#x27;</span>  <span class="built_in">log</span></span><br><span class="line">FILENAME ARGC  FNR   FS   NF   NR  OFS  ORS   RS</span><br><span class="line">---------------------------------------------</span><br><span class="line"> <span class="built_in">log</span>    2    1    :    1    1         </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"> <span class="built_in">log</span>    2    2    :    1    2         </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"> <span class="built_in">log</span>    2    3    :    1    3         </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"> <span class="built_in">log</span>    2    4    :    1    4         </span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="输出顺序号-NR-匹配文本行号">输出顺序号 NR, 匹配文本行号</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;&#123;print NR,FNR,$1,$2,$3&#125;&#x27;</span> <span class="built_in">log</span></span><br><span class="line">1 1 2 this is</span><br><span class="line">2 2 3 Are you</span><br><span class="line">3 3 This<span class="string">&#x27;s a test</span></span><br><span class="line"><span class="string">4 4 10 There are</span></span><br></pre></td></tr></table></figure><h5 id="指定输出分割符">指定输出分割符</h5><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">python<span class="variable">@ubuntu</span><span class="symbol">:~/test</span><span class="variable">$ </span>cat log.txt </span><br><span class="line"><span class="number">2</span> this is a test</span><br><span class="line"><span class="number">3</span> <span class="title class_">Are</span> you like awk</span><br><span class="line"><span class="title class_">This</span><span class="string">&#x27;s a test</span></span><br><span class="line"><span class="string">10 There are orange,apple,mongo</span></span><br><span class="line"><span class="string">python@ubuntu:~/test$ awk &#x27;</span>&#123;print <span class="variable">$1</span>,<span class="variable">$2</span>,<span class="variable">$5</span>&#125;<span class="string">&#x27; OFS=&quot; $ &quot;  log.txt</span></span><br><span class="line"><span class="string">2 $ this $ test</span></span><br><span class="line"><span class="string">3 $ Are $ awk</span></span><br><span class="line"><span class="string">This&#x27;</span>s <span class="variable">$ </span>a <span class="variable">$ </span></span><br><span class="line"><span class="number">10</span> <span class="variable">$ </span><span class="title class_">There</span> <span class="variable">$ </span></span><br><span class="line"><span class="number">12345678910</span></span><br></pre></td></tr></table></figure><h5 id="忽略大小写">忽略大小写</h5><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">$ awk &#x27;BEGIN&#123;IGNORECASE=1&#125; /this/&#x27; log.txt</span></span><br><span class="line"><span class="section">---------------------------------------------</span></span><br><span class="line">2 this is a test</span><br><span class="line">This&#x27;s a test</span><br><span class="line">1234</span><br></pre></td></tr></table></figure><h4 id="RS-ORS-FS-OFS区别与联系">RS,ORS,FS,OFS区别与联系</h4><p>学习awk时，一定要记得动手去实践，只有在实践中才能发现问题，以下就我在学习中和实践中的经验，总结一下RS,ORS,FS,OFS的区别和联系。</p><p><strong>一，RS与ORS</strong></p><p>1，RS是记录<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%88%86%E9%9A%94%E7%AC%A6&amp;spm=1001.2101.3001.7020">分隔符</a>，默认的分隔符是\n，具体用法看下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> test1</span><br><span class="line">111 222</span><br><span class="line">333 444</span><br><span class="line">555 666</span><br></pre></td></tr></table></figure><p>2，RS默认分割符\n</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;&#123;print $0&#125;&#x27;</span> test1  //awk <span class="string">&#x27;BEGIN&#123;RS=&quot;\n&quot;&#125;&#123;print $0&#125;&#x27;</span> test1 这二个是一样的</span><br><span class="line">111 222</span><br><span class="line">333 444</span><br><span class="line">555 666</span><br></pre></td></tr></table></figure><p>其实你可以把<strong>上面test1文件里的内容理解为，111 222\n333 444\n555 6666，利用\n进行分割</strong>。看下一个例子</p><p>3，自定义RS分割符</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">echo</span> <span class="string">&quot;111 222|333 444|555 666&quot;</span>|awk <span class="string">&#x27;BEGIN&#123;RS=&quot;|&quot;&#125;&#123;print $0,RT&#125;&#x27;</span></span><br><span class="line">111 222 |</span><br><span class="line">333 444 |</span><br><span class="line">555 666</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>结合上面一个例子，就很容易理解RS的用法了。</p><p>4，RS也可能是正则表达式</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">echo</span> <span class="string">&quot;111 222a333 444b555 666&quot;</span>|awk <span class="string">&#x27;BEGIN&#123;RS=&quot;[a-z]+&quot;&#125;&#123;print $1,RS,RT&#125;&#x27;</span></span><br><span class="line">111 [a-z]+ a</span><br><span class="line">333 [a-z]+ b</span><br><span class="line">555 [a-z]+</span><br></pre></td></tr></table></figure><p>从例3和例4，我们可以发现一点，<strong>当RT是利用RS匹配出来的内容。如果RS是某个固定的值时，RT就是RS的内容</strong>。</p><p>5，RS为空时</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> -n test2</span><br><span class="line">     1	111 222</span><br><span class="line">     2	</span><br><span class="line">     3	333 444</span><br><span class="line">     4	333 444</span><br><span class="line">     5	</span><br><span class="line">     6	</span><br><span class="line">     7	555 666</span><br><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN&#123;RS=&quot;&quot;&#125;&#123;print $0&#125;&#x27;</span> test2</span><br><span class="line">111 222</span><br><span class="line">333 444</span><br><span class="line">333 444</span><br><span class="line">555 666</span><br><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN&#123;RS=&quot;&quot;&#125;&#123;print &quot;&lt;&quot;,$0,&quot;&gt;&quot;&#125;&#x27;</span> test2</span><br><span class="line">&lt; 111 222 &gt;</span><br><span class="line">&lt; 333 444       //这一行和下面一行，是一行 </span><br><span class="line">333 444 &gt;</span><br><span class="line">&lt; 555 666 &gt;</span><br></pre></td></tr></table></figure><p>6，ORS记录输出分符符，默认值是\n</p><p><strong>把ORS理解成RS反过程，这样更容易记忆和理解</strong>，看下面的例子。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN&#123;ORS=&quot;\n&quot;&#125;&#123;print $0&#125;&#x27;</span> test1 //awk <span class="string">&#x27;&#123;print $0&#125;&#x27;</span> test1二者是一样的</span><br><span class="line">111 222</span><br><span class="line">333 444</span><br><span class="line">555 666</span><br><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN&#123;ORS=&quot;|&quot;&#125;&#123;print $0&#125;&#x27;</span> test1 </span><br><span class="line">111 222|333 444|555 666|[root@rocky8:~]# </span><br></pre></td></tr></table></figure><p><strong>二，FS与OFS</strong>（不理解）</p><p>1，FS指定列分割符</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">echo</span> <span class="string">&quot;111|222|333&quot;</span>|awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span> </span><br><span class="line">111|222|333</span><br><span class="line">[root@rocky8:~]# <span class="built_in">echo</span> <span class="string">&quot;111|222|333&quot;</span>|awk <span class="string">&#x27;BEGIN&#123;FS=&quot;|&quot;&#125;&#123;print $1&#125;&#x27;</span> </span><br><span class="line">111</span><br></pre></td></tr></table></figure><p>2，FS也可以用正则</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">echo</span> <span class="string">&quot;111||222|333&quot;</span>|awk <span class="string">&#x27;BEGIN&#123;FS=&quot;[|]+&quot;&#125;&#123;print $1&#125;&#x27;</span>  </span><br><span class="line">111</span><br></pre></td></tr></table></figure><p>3，FS为空的时候（不理解为啥要NF++）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">echo</span> <span class="string">&quot;111|222|333&quot;</span>|awk <span class="string">&#x27;BEGIN&#123;FS=&quot;&quot;&#125;&#123;NF++;print $0&#125;&#x27;</span></span><br><span class="line">1 1 1 | 2 2 2 | 3 3 3 </span><br></pre></td></tr></table></figure><p><strong>当FS为空的时候，awk会把一行中的每个字符，当成一列来处理</strong>。</p><p>4，RS被设定成非\n时，\n会成FS分割符中的一个</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> test1</span><br><span class="line">111 222</span><br><span class="line">333 444</span><br><span class="line">555 666</span><br><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN&#123;RS=&quot;444&quot;;&#125;&#123;print $2,$3&#125;&#x27;</span> test1</span><br><span class="line">222 333</span><br><span class="line">666</span><br></pre></td></tr></table></figure><p><strong>222和333之间是有一个\n的，当RS设定成444后，222和333被认定成同一行的二列了，其实按常规思想是二行的一列才对</strong>。</p><p>5，OFS列输出分隔符</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN&#123;OFS=&quot;|&quot;;&#125;&#123;print $1,$2&#125;&#x27;</span> test1</span><br><span class="line">111|222</span><br><span class="line">333|444</span><br><span class="line">555|666</span><br><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN&#123;OFS=&quot;|&quot;;&#125;&#123;print $1 OFS $2&#125;&#x27;</span> test1  </span><br><span class="line">111|222</span><br><span class="line">333|444</span><br><span class="line">555|666</span><br></pre></td></tr></table></figure><p><strong>test1只有二列，如果100列，都写出来太麻烦了吧。</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN&#123;OFS=&quot;|&quot;;&#125;&#123;print $0&#125;&#x27;</span> test1  </span><br><span class="line">111 222</span><br><span class="line">333 444</span><br><span class="line">555 666</span><br><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN&#123;OFS=&quot;|&quot;;&#125;&#123;NF=NF;print $0&#125;&#x27;</span> test1 </span><br><span class="line">111|222</span><br><span class="line">333|444</span><br><span class="line">555|666</span><br></pre></td></tr></table></figure><p>为什么第二种方法中的OFS生效呢？个人觉得，<strong>awk觉查到列有所变化时，就会让OFS生效</strong>，没变化直接输出了。</p><p>此部分转自：<strong>海底苍鹰：</strong><a target="_blank" rel="noopener" href="http://blog.51yip.com/shell/1151.html">awk中RS,ORS,FS,OFS区别与联系</a></p><h4 id="正则字符串匹配">正则字符串匹配</h4><p><strong>~ 表示模式开始。// 中是模式。</strong></p><p>输出第二列包含 “th”，并打印第二列与第四列：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;$2 ~ /th/ &#123;print $2,$4&#125;&#x27;</span> <span class="built_in">log</span> </span><br><span class="line">this a</span><br></pre></td></tr></table></figure><p>输出包含&quot;re&quot;的行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;/re/ &#123;print $0&#125;&#x27;</span> <span class="built_in">log</span> </span><br><span class="line">3 Are you like awk</span><br><span class="line">10 There are orange,apple,mongo</span><br></pre></td></tr></table></figure><p><strong>!表示取反</strong></p><p>输出第二列不包含 “th”，并打印第二列与第四列：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;$2 !~ /th/ &#123;print $0&#125;&#x27;</span> <span class="built_in">log</span> </span><br><span class="line">3 Are you like awk</span><br><span class="line">This<span class="string">&#x27;s a test</span></span><br><span class="line"><span class="string">10 There are orange,apple,mongo</span></span><br></pre></td></tr></table></figure><p>输出不包含&quot;re&quot;的行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;!/re/ &#123;print $0&#125;&#x27;</span> <span class="built_in">log</span> </span><br><span class="line">2 this is a <span class="built_in">test</span></span><br><span class="line">This<span class="string">&#x27;s a test</span></span><br></pre></td></tr></table></figure><h4 id="一些实例">一些实例</h4><p><strong>计算文件大小</strong></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="keyword">ls</span> -<span class="keyword">l</span> | awk &#x27;&#123;<span class="keyword">sum</span>+=<span class="variable">$5&#125;</span>END&#123;<span class="keyword">print</span> <span class="keyword">sum</span>&#125;&#x27;</span><br><span class="line">1066</span><br></pre></td></tr></table></figure><p><strong>从文件中找出长度大于80的行</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;length&gt;80&#x27;</span> <span class="built_in">log</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">seq</span> 100|sed <span class="string">&quot;:a;N;s/\n//g;ta&quot;</span> &gt;&gt; <span class="built_in">log</span></span><br><span class="line">[root@rocky8:~]# <span class="built_in">cat</span> <span class="built_in">log</span></span><br><span class="line">2 this is a <span class="built_in">test</span></span><br><span class="line">3 Are you like awk</span><br><span class="line">This<span class="string">&#x27;s a test</span></span><br><span class="line"><span class="string">10 There are orange,apple,mongo</span></span><br><span class="line"><span class="string">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100</span></span><br><span class="line"><span class="string">[root@rocky8:~]# awk &#x27;</span>length&gt;80<span class="string">&#x27; log</span></span><br><span class="line"><span class="string">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100</span></span><br></pre></td></tr></table></figure><p><strong>打印九九乘法表</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">seq</span> 9 | sed <span class="string">&#x27;H;g&#x27;</span> | awk -v RS=<span class="string">&#x27;&#x27;</span> <span class="string">&#x27;&#123;for(i=1;i&lt;=NF;i++)printf(&quot;%dx%d=%d%s&quot;, i, NR, i*NR, i==NR?&quot;\n&quot;:&quot;\t&quot;)&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>访问日志分析</strong></p><p>日志格式</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# <span class="built_in">head</span> access.log -n1</span><br><span class="line">42.236.10.75 <span class="string">&quot;changtou.xiaoxiaoming.xyz&quot;</span> [14/Oct/2019:12:47:18 +0800] <span class="string">&quot;GET /logo/8@3x.png HTTP/1.1&quot;</span> 200 26053 <span class="string">&quot;https://changtou.xiaoxiaoming.xyz/&quot;</span> <span class="string">&quot;Mozilla/5.0 (Linux; U; Android 8.1.0; zh-CN; EML-AL00 Build/HUAWEIEML-AL00) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 baidu.sogo.uc.UCBrowser/11.9.4.974 UWS/2.13.1.48 Mobile Safari/537.36 AliApp(DingTalk/4.5.11) com.alibaba.android.rimet/10487439 Channel/227200 language/zh-CN&quot;</span> <span class="string">&quot;42.236.10.75&quot;</span> rt=<span class="string">&quot;0.000&quot;</span> uct=<span class="string">&quot;-&quot;</span> uht=<span class="string">&quot;-&quot;</span> urt=<span class="string">&quot;-&quot;</span></span><br></pre></td></tr></table></figure><p>示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1.数据清洗</span><br><span class="line">awk <span class="string">&#x27;($6 ~ /.html/) &amp;&amp; ($8 ~ /200/)  &#123;print $0&#125;&#x27;</span> access.log &gt; clean.log</span><br><span class="line"></span><br><span class="line">2.统计PV</span><br><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;&#123;print $0&#125;&#x27;</span>  clean.log | <span class="built_in">wc</span> -l</span><br><span class="line">700</span><br><span class="line">[root@rocky8:~]# <span class="built_in">cut</span> -d <span class="string">&#x27; &#x27;</span> -f 1 clean.log|<span class="built_in">wc</span> -l    </span><br><span class="line">700</span><br><span class="line"></span><br><span class="line">3:UV</span><br><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>  clean.log |<span class="built_in">sort</span>|<span class="built_in">uniq</span>| <span class="built_in">wc</span> -l</span><br><span class="line">155</span><br><span class="line">[root@rocky8:~]# <span class="built_in">cut</span> -d <span class="string">&#x27; &#x27;</span> -f 1 clean.log|<span class="built_in">sort</span>|<span class="built_in">uniq</span>| <span class="built_in">wc</span> -l</span><br><span class="line">155</span><br><span class="line"></span><br><span class="line">4:获取每天访问网站最多的前10名用户</span><br><span class="line">awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span> clean.log|<span class="built_in">sort</span>|<span class="built_in">uniq</span> -c|<span class="built_in">sort</span> -k 1nr|<span class="built_in">head</span></span><br><span class="line">或</span><br><span class="line"><span class="built_in">cut</span> -d <span class="string">&#x27; &#x27;</span> -f 1 clean.log|<span class="built_in">sort</span>|<span class="built_in">uniq</span> -c|<span class="built_in">sort</span> -k 1nr|<span class="built_in">head</span></span><br></pre></td></tr></table></figure><h3 id="awk编程">awk编程</h3><h4 id="条件语句IF-ELSE">条件语句IF&amp;ELSE</h4><p>IF 条件语句语法格式如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (condition)</span><br><span class="line">    action</span><br></pre></td></tr></table></figure><p>也可以使用花括号来执行一组操作：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (condition)</span><br><span class="line">&#123;</span><br><span class="line">    action-1</span><br><span class="line">    action-2</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    action-n</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>判断数字是奇数还是偶数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN &#123;num = 10; if (num % 2 == 0) printf &quot;%d 是偶数\n&quot;, num &#125;&#x27;</span></span><br><span class="line">10 是偶数</span><br></pre></td></tr></table></figure><p>IF - ELSE 条件语句语法格式如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (condition)</span><br><span class="line">    action-1</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    action-2</span><br><span class="line">1234</span><br></pre></td></tr></table></figure><p>在条件语句 condition 为 true 时只需 action-1，否则执行 action-2。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN &#123;</span></span><br><span class="line"><span class="string">&gt;     num = 11; </span></span><br><span class="line"><span class="string">&gt;     if (num % 2 == 0) printf &quot;%d 是偶数\n&quot;, num; </span></span><br><span class="line"><span class="string">&gt;     else printf &quot;%d 是奇数\n&quot;, num </span></span><br><span class="line"><span class="string">&gt; &#125;&#x27;</span></span><br><span class="line">11 是奇数</span><br><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN &#123;num = 11; if (num % 2 == 0) printf &quot;%d 是偶数\n&quot;, num; else printf &quot;%d 是奇数\n&quot;, num &#125;&#x27;</span></span><br><span class="line">11 是奇数</span><br></pre></td></tr></table></figure><p>可以创建多个 IF - ELSE 格式的判断语句来实现多个条件的判断：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN &#123;</span></span><br><span class="line"><span class="string">a=30;</span></span><br><span class="line"><span class="string">if (a==10)</span></span><br><span class="line"><span class="string">  print &quot;a = 10&quot;;</span></span><br><span class="line"><span class="string">else if (a == 20)</span></span><br><span class="line"><span class="string">  print &quot;a = 20&quot;;</span></span><br><span class="line"><span class="string">else if (a == 30)</span></span><br><span class="line"><span class="string">  print &quot;a = 30&quot;;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@rocky8:~]# awk <span class="string">&#x27;BEGIN &#123;</span></span><br><span class="line"><span class="string">&gt; a=30;</span></span><br><span class="line"><span class="string">&gt; if (a==10)</span></span><br><span class="line"><span class="string">&gt;   print &quot;a = 10&quot;;</span></span><br><span class="line"><span class="string">&gt; else if (a == 20)</span></span><br><span class="line"><span class="string">&gt;   print &quot;a = 20&quot;;</span></span><br><span class="line"><span class="string">&gt; else if (a == 30)</span></span><br><span class="line"><span class="string">&gt;   print &quot;a = 30&quot;;</span></span><br><span class="line"><span class="string">&gt; &#125;&#x27;</span></span><br><span class="line">a = 30</span><br></pre></td></tr></table></figure><h4 id="循环语句For-While">循环语句For&amp;While</h4><p>For 循环的语法如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (initialisation; condition; increment/decrement)</span><br><span class="line">    action</span><br></pre></td></tr></table></figure><p>下面的例子使用 For 循环输出数字 1 至 5：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python@ubuntu:~/test$ awk <span class="string">&#x27;BEGIN &#123; for (i = 1; i &lt;= 5; ++i) print i &#125;&#x27;</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td></tr></table></figure><p>While 循环的语法如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (condition)</span><br><span class="line">    action</span><br></pre></td></tr></table></figure><p>下面是使用 While 循环输出数字 1 到 5 的例子：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python@ubuntu:~/test$ awk <span class="string">&#x27;BEGIN &#123;i = 1; while (i &lt; 6) &#123; print i; ++i &#125; &#125;&#x27;</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td></tr></table></figure><p>在下面的示例子中，当计算的和大于 50 的时候使用 break 结束循环：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN &#123;</span></span><br><span class="line"><span class="string">   sum = 0; for (i = 0; i &lt; 20; ++i) &#123; </span></span><br><span class="line"><span class="string">      sum += i; if (sum &gt; 50) break; else print &quot;Sum =&quot;, sum </span></span><br><span class="line"><span class="string">   &#125; </span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>输出结果为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">python@ubuntu:~/test$ awk <span class="string">&#x27;BEGIN &#123;</span></span><br><span class="line"><span class="string">&gt;    sum = 0; for (i = 0; i &lt; 20; ++i) &#123; </span></span><br><span class="line"><span class="string">&gt;       sum += i; if (sum &gt; 50) break; else print &quot;Sum =&quot;, sum </span></span><br><span class="line"><span class="string">&gt;    &#125; </span></span><br><span class="line"><span class="string">&gt; &#125;&#x27;</span></span><br><span class="line">Sum = 0</span><br><span class="line">Sum = 1</span><br><span class="line">Sum = 3</span><br><span class="line">Sum = 6</span><br><span class="line">Sum = 10</span><br><span class="line">Sum = 15</span><br><span class="line">Sum = 21</span><br><span class="line">Sum = 28</span><br><span class="line">Sum = 36</span><br><span class="line">Sum = 45</span><br></pre></td></tr></table></figure><p>Continue 语句用于在循环体内部结束本次循环，从而直接进入下一次循环迭代。</p><p>下面的例子输出 1 到 20 之间的偶数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">python@ubuntu:~/test$ awk <span class="string">&#x27;BEGIN &#123;for (i = 1; i &lt;= 20; ++i) &#123;if (i % 2 == 0) print i ; else continue&#125; &#125;&#x27;</span></span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line">10</span><br><span class="line">12</span><br><span class="line">14</span><br><span class="line">16</span><br><span class="line">18</span><br><span class="line">20</span><br></pre></td></tr></table></figure><p>Exit 用于结束脚本程序的执行。</p><p>该函数接受一个整数作为参数表示 AWK 进程结束状态。 如果没有提供该参数，其默认状态为 0。</p><p>下面例子中当和大于 50 时结束 AWK 程序。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN &#123;</span></span><br><span class="line"><span class="string">   sum = 0; for (i = 0; i &lt; 20; ++i) &#123;</span></span><br><span class="line"><span class="string">      sum += i; if (sum &gt; 50) exit(10); else print &quot;Sum =&quot;, sum </span></span><br><span class="line"><span class="string">   &#125; </span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>输出结果为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">python@ubuntu:~/test$ awk <span class="string">&#x27;BEGIN &#123;</span></span><br><span class="line"><span class="string">&gt;    sum = 0; for (i = 0; i &lt; 20; ++i) &#123;</span></span><br><span class="line"><span class="string">&gt;       sum += i; if (sum &gt; 50) exit(10); else print &quot;Sum =&quot;, sum </span></span><br><span class="line"><span class="string">&gt;    &#125; </span></span><br><span class="line"><span class="string">&gt; &#125;&#x27;</span></span><br><span class="line">Sum = 0</span><br><span class="line">Sum = 1</span><br><span class="line">Sum = 3</span><br><span class="line">Sum = 6</span><br><span class="line">Sum = 10</span><br><span class="line">Sum = 15</span><br><span class="line">Sum = 21</span><br><span class="line">Sum = 28</span><br><span class="line">Sum = 36</span><br><span class="line">Sum = 45</span><br><span class="line">python@ubuntu:~/test$ <span class="built_in">echo</span> $?</span><br><span class="line">10</span><br></pre></td></tr></table></figure><h4 id="awk数组">awk数组</h4><p>AWK的数组底层数据结构是散列表，索引可以是数字或字符串。</p><p>数组使用的语法格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_name[index]=value</span><br></pre></td></tr></table></figure><p>创建数组并访问数组元素：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN &#123;</span></span><br><span class="line"><span class="string">sites[&quot;taobao&quot;]=&quot;www.taobao.com&quot;;</span></span><br><span class="line"><span class="string">sites[&quot;google&quot;]=&quot;www.google.com&quot;</span></span><br><span class="line"><span class="string">print sites[&quot;taobao&quot;] &quot;\n&quot; sites[&quot;google&quot;]</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>删除数组元素语法格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete array_name[index]</span><br></pre></td></tr></table></figure><p>下面的例子中，数组中的 google 元素被删除（删除命令没有输出）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN &#123;</span></span><br><span class="line"><span class="string">sites[&quot;taobao&quot;]=&quot;www.taobao.com&quot;;</span></span><br><span class="line"><span class="string">sites[&quot;google&quot;]=&quot;www.google.com&quot;</span></span><br><span class="line"><span class="string">delete sites[&quot;google&quot;];</span></span><br><span class="line"><span class="string">print sites[&quot;google&quot;]</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>AWK 本身不支持多维数组，不过我们可以很容易地使用一维数组模拟实现多维数组。</p><p>如下示例为一个 3x3 的三维数组：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">100 200 300</span><br><span class="line">400 500 600</span><br><span class="line">700 800 900</span><br></pre></td></tr></table></figure><p>以上实例中，<code>array[0][0]</code> 存储 100，<code>array[0][1]</code> 存储 200 ，依次类推。为了在 <code>array[0][0]</code> 处存储 100, 可以使用字符串0,0 作为索引： array[“0,0”] = 100。</p><p>下面是模拟二维数组的例子：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN &#123;</span></span><br><span class="line"><span class="string">array[&quot;0,0&quot;] = 100;</span></span><br><span class="line"><span class="string">array[&quot;0,1&quot;] = 200;</span></span><br><span class="line"><span class="string">array[&quot;0,2&quot;] = 300;</span></span><br><span class="line"><span class="string">array[&quot;1,0&quot;] = 400;</span></span><br><span class="line"><span class="string">array[&quot;1,1&quot;] = 500;</span></span><br><span class="line"><span class="string">array[&quot;1,2&quot;] = 600;</span></span><br><span class="line"><span class="string"># 输出数组元素</span></span><br><span class="line"><span class="string">print &quot;array[0,0] = &quot; array[&quot;0,0&quot;];</span></span><br><span class="line"><span class="string">print &quot;array[0,1] = &quot; array[&quot;0,1&quot;];</span></span><br><span class="line"><span class="string">print &quot;array[0,2] = &quot; array[&quot;0,2&quot;];</span></span><br><span class="line"><span class="string">print &quot;array[1,0] = &quot; array[&quot;1,0&quot;];</span></span><br><span class="line"><span class="string">print &quot;array[1,1] = &quot; array[&quot;1,1&quot;];</span></span><br><span class="line"><span class="string">print &quot;array[1,2] = &quot; array[&quot;1,2&quot;];</span></span><br><span class="line"><span class="string">&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>执行上面的命令可以得到如下结果：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">array[0,0] = 100</span><br><span class="line">array[0,1] = 200</span><br><span class="line">array[0,2] = 300</span><br><span class="line">array[1,0] = 400</span><br><span class="line">array[1,1] = 500</span><br><span class="line">array[1,2] = 600</span><br></pre></td></tr></table></figure><p>在数组上可以执行很多操作，比如，使用 asort 完成数组元素的排序，或者使用 asorti 实现数组索引的排序等等。</p><h4 id="AWK-用户自定义函数">AWK 用户自定义函数</h4><p>自定义函数的语法格式为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> function_name(argument1, argument2, ...)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">function</span> body</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以下实例实现了两个简单函数，它们分别返回两个数值中的最小值和最大值。</p><p>文件 functions.awk 代码如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 返回最小值</span></span><br><span class="line"><span class="keyword">function</span> find_min(num1, num2)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (num1 &lt; num2)</span><br><span class="line">    <span class="built_in">return</span> num1</span><br><span class="line">  <span class="built_in">return</span> num2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回最大值</span></span><br><span class="line"><span class="keyword">function</span> find_max(num1, num2)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (num1 &gt; num2)</span><br><span class="line">    <span class="built_in">return</span> num1</span><br><span class="line">  <span class="built_in">return</span> num2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主函数</span></span><br><span class="line"><span class="keyword">function</span> main(num1, num2)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment"># 查找最小值</span></span><br><span class="line">  result = find_min(10, 20)</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;Minimum =&quot;</span>, result</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 查找最大值</span></span><br><span class="line">  result = find_max(10, 20)</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;Maximum =&quot;</span>, result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 脚本从这里开始执行</span></span><br><span class="line">BEGIN &#123;</span><br><span class="line">  main(10, 20)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行 functions.awk 文件，可以得到如下的结果：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ awk -f functions.awk </span><br><span class="line">Minimum = 10</span><br><span class="line">Maximum = 20</span><br></pre></td></tr></table></figure><h4 id="AWK-内置函数">AWK 内置函数</h4><p>AWK 内置函数主要有以下几种：</p><ul class="lvl-0"><li class="lvl-2"><p>算数函数</p></li><li class="lvl-2"><p>字符串函数</p></li><li class="lvl-2"><p>时间函数</p></li><li class="lvl-2"><p>位操作函数</p></li><li class="lvl-2"><p>其它函数</p></li></ul><h4 id="算数函数">算数函数</h4><table><thead><tr><th><strong>函数名</strong></th><th><strong>说明</strong></th><th><strong>实例</strong></th></tr></thead><tbody><tr><td>atan2( y, x )</td><td>返回 y/x 的反正切。</td><td><code>$ awk 'BEGIN &#123; PI = 3.14159265 x = -10 y = 10 result = atan2 (y,x) * 180 / PI; printf &quot;The arc tangent for (x=%f, y=%f) is %f degrees\n&quot;, x, y, result &#125;'</code>输出结果为：<code>The arc tangent for (x=-10.000000, y=10.000000) is 135.000000 degrees</code></td></tr><tr><td>cos( x )</td><td>返回 x 的余弦；x 是弧度。</td><td><code>$ awk 'BEGIN &#123; PI = 3.14159265 param = 60 result = cos(param * PI / 180.0); printf &quot;The cosine of %f degrees is %f.\n&quot;, param, result &#125;'</code>输出结果为：<code>The cosine of 60.000000 degrees is 0.500000.</code></td></tr><tr><td>sin( x )</td><td>返回 x 的正弦；x 是弧度。</td><td><code>$ awk 'BEGIN &#123; PI = 3.14159265 param = 30.0 result = sin(param * PI /180) printf &quot;The sine of %f degrees is %f.\n&quot;, param, result &#125;'</code>输出结果为：<code>The sine of 30.000000 degrees is 0.500000.</code></td></tr><tr><td>exp( x )</td><td>返回 x 幂函数。</td><td><code>$ awk 'BEGIN &#123; param = 5 result = exp(param); printf &quot;The exponential value of %f is %f.\n&quot;, param, result &#125;'</code>输出结果为：<code>The exponential value of 5.000000 is 148.413159.</code></td></tr><tr><td>log( x )</td><td>返回 x 的自然对数。</td><td><code>$ awk 'BEGIN &#123; param = 5.5 result = log (param) printf &quot;log(%f) = %f\n&quot;, param, result &#125;'</code>输出结果为：<code>log(5.500000) = 1.704748</code></td></tr><tr><td>sqrt( x )</td><td>返回 x 平方根。</td><td><code>$ awk 'BEGIN &#123; param = 1024.0 result = sqrt(param) printf &quot;sqrt(%f) = %f\n&quot;, param, result &#125;'</code>输出结果为：<code>sqrt(1024.000000) = 32.000000</code></td></tr><tr><td>int( x )</td><td>返回 x 的截断至整数的值。</td><td><code>$ awk 'BEGIN &#123; param = 5.12345 result = int(param) print &quot;Truncated value =&quot;, result &#125;'</code>输出结果为：<code>Truncated value = 5</code></td></tr><tr><td>rand( )</td><td>返回任意数字 n，其中 0 &lt;= n &lt; 1。</td><td><code>$ awk 'BEGIN &#123; print &quot;Random num1 =&quot; , rand() print &quot;Random num2 =&quot; , rand() print &quot;Random num3 =&quot; , rand() &#125;'</code>输出结果为：<code>Random num1 = 0.237788 Random num2 = 0.291066 Random num3 = 0.845814</code></td></tr><tr><td>srand( [Expr] )</td><td>将 rand 函数的种子值设置为 Expr 参数的值，或如果省略 Expr 参数则使用某天的时间。返回先前的种子值。</td><td><code>$ awk 'BEGIN &#123; param = 10 printf &quot;srand() = %d\n&quot;, srand() printf &quot;srand(%d) = %d\n&quot;, param, srand(param) &#125;'</code>输出结果为：<code>srand() = 1 srand(10) = 1417959587</code></td></tr></tbody></table><h5 id="字符串函数">字符串函数</h5><table><thead><tr><th><strong>函数</strong></th><th><strong>说明</strong></th><th><strong>实例</strong></th></tr></thead><tbody><tr><td>gsub( Ere, Repl, [ In ] )</td><td>gsub 是全局替换( global substitution )的缩写。除了正则表达式所有具体值被替代这点，它和 sub 函数完全一样地执行。</td><td><code>$ awk 'BEGIN &#123; str = &quot;Hello, World&quot; print &quot;String before replacement = &quot; str gsub(&quot;World&quot;, &quot;Jerry&quot;, str) print &quot;String after replacement = &quot; str &#125;'</code>输出结果为：<code>String before replacement = Hello, World String after replacement = Hello, Jerry</code></td></tr><tr><td>sub(regex,sub,string)</td><td>sub 函数执行一次子串替换。它将第一次出现的子串用 regex 替换。第三个参数是可选的，默认为 $0。</td><td><code>$ awk 'BEGIN &#123; str = &quot;Hello, World&quot; print &quot;String before replacement = &quot; str sub(&quot;World&quot;, &quot;Jerry&quot;, str) print &quot;String after replacement = &quot; str &#125;'</code>输出结果为：<code>String before replacement = Hello, World String after replacement = Hello, Jerry</code></td></tr><tr><td>substr(str, start, l)</td><td>substr 函数返回 str 字符串中从第 start 个字符开始长度为 l 的子串。如果没有指定 l 的值，返回 str 从第 start 个字符开始的后缀子串。</td><td><code>$ awk 'BEGIN &#123; str = &quot;Hello, World !!!&quot; subs = substr(str, 1, 5) print &quot;Substring = &quot; subs &#125;'</code>输出结果为：<code>Substring = Hello</code></td></tr><tr><td>index( String1, String2 )</td><td>在由 String1 参数指定的字符串（其中有出现 String2 指定的参数）中，返回位置，从 1 开始编号。如果 String2 参数不在 String1 参数中出现，则返回 0（零）。</td><td><code>$ awk 'BEGIN &#123; str = &quot;One Two Three&quot; subs = &quot;Two&quot; ret = index(str, subs) printf &quot;Substring \&quot;%s\&quot; found at %d location.\n&quot;, subs, ret &#125;'</code>输出结果为：<code>Substring &quot;Two&quot; found at 5 location.</code></td></tr><tr><td>length [(String)]</td><td>返回 String 参数指定的字符串的长度（字符形式）。如果未给出 String 参数，则返回整个记录的长度（$0 记录变量）。</td><td><code>$ awk 'BEGIN &#123; str = &quot;Hello, World !!!&quot; print &quot;Length = &quot;, length(str) &#125;'</code>输出结果为：<code>Substring &quot;Two&quot; found at 5 location.</code></td></tr><tr><td>blength [(String)]</td><td>返回 String 参数指定的字符串的长度（以字节为单位）。如果未给出 String 参数，则返回整个记录的长度（$0 记录变量）。</td><td></td></tr><tr><td>substr( String, M, [ N ] )</td><td>返回具有 N 参数指定的字符数量子串。子串从 String 参数指定的字符串取得，其字符以 M 参数指定的位置开始。M 参数指定为将 String 参数中的第一个字符作为编号 1。如果未指定 N 参数，则子串的长度将是 M 参数指定的位置到 String 参数的末尾 的长度。</td><td><code>$ awk 'BEGIN &#123; str = &quot;Hello, World !!!&quot; subs = substr(str, 1, 5) print &quot;Substring = &quot; subs &#125;'</code>输出结果为：<code>Substring = Hello</code></td></tr><tr><td>match( String, Ere )</td><td>在 String 参数指定的字符串（Ere 参数指定的扩展正则表达式出现在其中）中返回位置（字符形式），从 1 开始编号，或如果 Ere 参数不出现，则返回 0（零）。RSTART 特殊变量设置为返回值。RLENGTH 特殊变量设置为匹配的字符串的长度，或如果未找到任何匹配，则设置为 -1（负一）。</td><td><code>$ awk 'BEGIN &#123; str = &quot;One Two Three&quot; subs = &quot;Two&quot; ret = match(str, subs) printf &quot;Substring \&quot;%s\&quot; found at %d location.\n&quot;, subs, ret &#125;'</code>输出结果为：<code>Substring &quot;Two&quot; found at 5 location.</code></td></tr><tr><td>split( String, A, [Ere] )</td><td>将 String 参数指定的参数分割为数组元素 A[1], A[2], . . ., A[n]，并返回 n 变量的值。此分隔可以通过 Ere 参数指定的扩展正则表达式进行，或用当前字段分隔符（FS 特殊变量）来进行（如果没有给出 Ere 参数）。除非上下文指明特定的元素还应具有一个数字值，否则 A 数组中的元素用字符串值来创建。</td><td><code>$ awk 'BEGIN &#123; str = &quot;One,Two,Three,Four&quot; split(str, arr, &quot;,&quot;) print &quot;Array contains following values&quot; for (i in arr) &#123; print arr[i] &#125; &#125;'</code>输出结果为：<code>Array contains following values One Two Three Four</code></td></tr><tr><td>tolower( String )</td><td>返回 String 参数指定的字符串，字符串中每个大写字符将更改为小写。大写和小写的映射由当前语言环境的 LC_CTYPE 范畴定义。</td><td><code>$ awk 'BEGIN &#123; str = &quot;HELLO, WORLD !!!&quot; print &quot;Lowercase string = &quot; tolower(str) &#125;'</code>输出结果为：<code>Lowercase string = hello, world !!!</code></td></tr><tr><td>toupper( String )</td><td>返回 String 参数指定的字符串，字符串中每个小写字符将更改为大写。大写和小写的映射由当前语言环境的 LC_CTYPE 范畴定义。</td><td><code>$ awk 'BEGIN &#123; str = &quot;hello, world !!!&quot; print &quot;Uppercase string = &quot; toupper(str) &#125;'</code>输出结果为：<code>Uppercase string = HELLO, WORLD !!!</code></td></tr><tr><td>sprintf(Format, Expr, Expr, . . . )</td><td>根据 Format 参数指定的 printf 子例程格式字符串来格式化 Expr 参数指定的表达式并返回最后生成的字符串。</td><td><code>$ awk 'BEGIN &#123; str = sprintf(&quot;%s&quot;, &quot;Hello, World !!!&quot;) print str &#125;'</code>输出结果为：<code>Hello, World !!!</code></td></tr><tr><td>strtonum(str)</td><td>strtonum 将字符串 str 转换为数值。 如果字符串以 0 开始，则将其当作十进制数；如果字符串以 0x 或 0X 开始，则将其当作十六进制数；否则，将其当作浮点数。</td><td><code>$ awk 'BEGIN &#123; print &quot;Decimal num = &quot; strtonum(&quot;123&quot;) print &quot;Octal num = &quot; strtonum(&quot;0123&quot;) print &quot;Hexadecimal num = &quot; strtonum(&quot;0x123&quot;) &#125;'</code>输出结果为：<code>Decimal num = 123 Octal num = 83 Hexadecimal num = 291</code></td></tr></tbody></table><p>**注：**<strong>Ere</strong> 部分可以是正则表达式。</p><p><strong>1、gsub、sub 使用</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN&#123;info=&quot;this is a test2012test!&quot;;gsub(/[0-9]+/,&quot;||&quot;,info);print info&#125;&#x27;</span></span><br><span class="line">this is a <span class="built_in">test</span>||<span class="built_in">test</span>!</span><br></pre></td></tr></table></figure><p><strong>2、查找字符串（index 使用）</strong></p><p>使用了三元运算符: <strong>表达式 ? 动作1 : 动作2</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN&#123;info=&quot;this is a test2012test!&quot;;print index(info,&quot;11111&quot;)?&quot;ok&quot;:&quot;no found&quot;;&#125;&#x27;</span></span><br><span class="line">no found</span><br><span class="line">$ awk <span class="string">&#x27;BEGIN&#123;info=&quot;this is a test2012test!&quot;;print index(info,&quot;is&quot;)?&quot;ok&quot;:&quot;no found&quot;;&#125;&#x27;</span></span><br><span class="line">ok</span><br><span class="line">$ awk <span class="string">&#x27;BEGIN&#123;info=&quot;this is a test2012test!&quot;;print index(info,&quot;test&quot;)?&quot;ok&quot;:&quot;no found&quot;;&#125;&#x27;</span></span><br><span class="line">ok</span><br></pre></td></tr></table></figure><p><strong>3、正则表达式匹配查找(match 使用）</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN&#123;info=&quot;this is a test2012test!&quot;;print match(info,/[0-9]+/)?&quot;ok&quot;:&quot;no found&quot;;&#125;&#x27;</span></span><br><span class="line">ok</span><br></pre></td></tr></table></figure><p><strong>4、截取字符串(substr使用）</strong></p><p>从第 4 个 字符开始，截取 10 个长度字符串。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN&#123;info=&quot;this is a test2012test!&quot;;print substr(info,4,10);&#125;&#x27;</span></span><br><span class="line">s is a tes</span><br></pre></td></tr></table></figure><p><strong>5、字符串分割（split使用）</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ awk <span class="string">&#x27;BEGIN&#123;info=&quot;this is a test&quot;;split(info,tA,&quot; &quot;);print length(tA);for(k in tA)&#123;print k,tA[k];&#125;&#125;&#x27;</span></span><br><span class="line">4</span><br><span class="line">2 is</span><br><span class="line">3 a</span><br><span class="line">4 <span class="built_in">test</span></span><br><span class="line">1 this</span><br></pre></td></tr></table></figure><p>分割 info，将 info 字符串使用空格切分为动态数组 tA。注意 awk for …in 循环，是一个无序的循环。 并不是从数组下标 1…n ，因此使用时候需要特别注意。</p><h5 id="时间函数">时间函数</h5><table><thead><tr><th><strong>函数名</strong></th><th><strong>说明</strong></th><th><strong>实例</strong></th></tr></thead><tbody><tr><td>mktime( YYYY MM DD HH MM SS[ DST])</td><td>生成时间格式</td><td><code>$ awk 'BEGIN &#123; print &quot;Number of seconds since the Epoch = &quot; mktime(&quot;2014 12 14 30 20 10&quot;) &#125;'</code>输出结果为：<code>Number of seconds since the Epoch = 1418604610</code></td></tr><tr><td>strftime([format [, timestamp]])</td><td>格式化时间输出，将时间戳转为时间字符串 具体格式，见下表.</td><td><code>$ awk 'BEGIN &#123; print strftime(&quot;Time = %m/%d/%Y %H:%M:%S&quot;, systime()) &#125;'</code>输出结果为：<code>Time = 12/14/2014 22:08:42</code></td></tr><tr><td>systime()</td><td>得到时间戳,返回从1970年1月1日开始到当前时间(不计闰年)的整秒数</td><td><code>awk 'BEGIN&#123;now=systime();print now&#125;'</code>输出结果为：<code>1343210982</code></td></tr></tbody></table><p>strftime 日期和时间格式说明符:</p><table><thead><tr><th>序号</th><th>描述</th></tr></thead><tbody><tr><td>%a</td><td>星期缩写(Mon-Sun)。</td></tr><tr><td>%A</td><td>星期全称（Monday-Sunday）。</td></tr><tr><td>%b</td><td>月份缩写（Jan）。</td></tr><tr><td>%B</td><td>月份全称（January）。</td></tr><tr><td>%c</td><td>本地日期与时间。</td></tr><tr><td>%C</td><td>年份中的世纪部分，其值为年份整除100。</td></tr><tr><td>%d</td><td>十进制日期(01-31)</td></tr><tr><td>%D</td><td>等价于 %m/%d/%y.</td></tr><tr><td>%e</td><td>日期，如果只有一位数字则用空格补齐</td></tr><tr><td>%F</td><td>等价于 %Y-%m-%d，这也是 ISO 8601 标准日期格式。</td></tr><tr><td>%g</td><td>ISO8610 标准周所在的年份模除 100（00-99)。比如，1993 年 1 月 1 日属于 1992 年的第 53 周。所以，虽然它是 1993 年第 1 天，但是其　ISO8601 标准周所在年份却是 1992。同样，尽管 1973 年 12 月 31 日属于 1973 年但是它却属于 1994 年的第一周。所以 1973 年 12 月 31 日的 ISO8610　标准周所在的年是 1974 而不是 1973。</td></tr><tr><td>%G</td><td>ISO 标准周所在年份的全称。</td></tr><tr><td>%h</td><td>等价于 %b.</td></tr><tr><td>%H</td><td>用十进制表示的 24 小时格式的小时(00-23)</td></tr><tr><td>%I</td><td>用十进制表示的 12 小时格式的小时（00-12）</td></tr><tr><td>%j</td><td>一年中的第几天（001-366）</td></tr><tr><td>%m</td><td>月份（01-12）</td></tr><tr><td>%M</td><td>分钟数（00-59)</td></tr><tr><td>%n</td><td>换行符 (ASCII LF)</td></tr><tr><td>%p</td><td>十二进制表示法（AM/PM）</td></tr><tr><td>%r</td><td>十二进制表示法的时间（等价于 %I:%M:%S %p）。</td></tr><tr><td>%R</td><td>等价于 %H:%M。</td></tr><tr><td>%S</td><td>时间的秒数值（00-60）</td></tr><tr><td>%t</td><td>制表符 (tab)</td></tr><tr><td>%T</td><td>等价于 %H:%M:%S。</td></tr><tr><td>%u</td><td>以数字表示的星期(1-7),1 表示星期一。</td></tr><tr><td>%U</td><td>一年中的第几个星期（第一个星期天作为第一周的开始），00-53</td></tr><tr><td>%V</td><td>一年中的第几个星期（第一个星期一作为第一周的开始），01-53。</td></tr><tr><td>%w</td><td>以数字表示的星期（0-6），0表示星期日 。</td></tr><tr><td>%W</td><td>十进制表示的一年中的第几个星期（第一个星期一作为第一周的开始），00-53。</td></tr><tr><td>%x</td><td>本地日期表示</td></tr><tr><td>%X</td><td>本地时间表示</td></tr><tr><td>%y</td><td>年份模除 100。</td></tr><tr><td>%Y</td><td>十进制表示的完整年份。</td></tr><tr><td>%z</td><td>时区，表示格式为+HHMM（例如，格式要求生成的 RFC 822或者 RFC 1036 时间头）</td></tr><tr><td>%Z</td><td>时区名称或缩写，如果时区待定则无输出。</td></tr></tbody></table><h5 id="位操作函数">位操作函数</h5><table><thead><tr><th><strong>函数名</strong></th><th><strong>说明</strong></th><th><strong>实例</strong></th></tr></thead><tbody><tr><td>and</td><td>位与操作。</td><td><code>$ awk 'BEGIN &#123; num1 = 10 num2 = 6 printf &quot;(%d AND %d) = %d\n&quot;, num1, num2, and(num1, num2) &#125;'</code>输出结果为：<code>(10 AND 6) = 2</code></td></tr><tr><td>compl</td><td>按位求补。</td><td><code>$ awk 'BEGIN &#123; num1 = 10 printf &quot;compl(%d) = %d\n&quot;, num1, compl(num1) &#125;'</code>输出结果为：<code>compl(10) = 9007199254740981</code></td></tr><tr><td>lshift</td><td>左移位操作</td><td><code>$ awk 'BEGIN &#123; num1 = 10 printf &quot;lshift(%d) by 1 = %d\n&quot;, num1, lshift(num1, 1) &#125;'</code>输出结果为：<code>lshift(10) by 1 = 20</code></td></tr><tr><td>rshift</td><td>右移位操作</td><td><code>$ awk 'BEGIN &#123; num1 = 10 printf &quot;rshift(%d) by 1 = %d\n&quot;, num1, rshift(num1, 1) &#125;'</code>输出结果为：<code>rshift(10) by 1 = 5</code></td></tr><tr><td>or</td><td>按位或操作</td><td><code>$ awk 'BEGIN &#123; num1 = 10 num2 = 6 printf &quot;(%d OR %d) = %d\n&quot;, num1, num2, or(num1, num2) &#125;'</code>输出结果为：<code>(10 OR 6) = 14</code></td></tr><tr><td>xor</td><td>按位异或操作</td><td><code>$ awk 'BEGIN &#123; num1 = 10 num2 = 6 printf &quot;(%d XOR %d) = %d\n&quot;, num1, num2, xor(num1, num2) &#125;'</code>输出结果为：<code>(10 bitwise xor 6) = 12</code></td></tr></tbody></table><h5 id="其他函数">其他函数</h5><table><thead><tr><th><strong>函数名</strong></th><th><strong>说明</strong></th><th><strong>实例</strong></th></tr></thead><tbody><tr><td>close(expr)</td><td>关闭管道的文件</td><td>`$ awk 'BEGIN { cmd = “tr [a-z] [A-Z]” print “hello, world !!!”</td></tr><tr><td>delete</td><td>用于从数组中删除元素</td><td><code>$ awk 'BEGIN &#123; arr[0] = &quot;One&quot; arr[1] = &quot;Two&quot; arr[2] = &quot;Three&quot; arr[3] = &quot;Four&quot; print &quot;Array elements before delete operation:&quot; for (i in arr) &#123; print arr[i] &#125; delete arr[0] delete arr[1] print &quot;Array elements after delete operation:&quot; for (i in arr) &#123; print arr[i] &#125; &#125;'</code>输出结果为：<code>Array elements before delete operation: One Two Three Four Array elements after delete operation: Three Four</code></td></tr><tr><td>exit</td><td>终止脚本执行，它可以接受可选的参数 expr 传递 AWK 返回状态。</td><td><code>$ awk 'BEGIN &#123; print &quot;Hello, World !!!&quot; exit 10 print &quot;AWK never executes this statement.&quot; &#125;'</code>输出结果为：<code>Hello, World !!!</code></td></tr><tr><td>flush</td><td>刷新打开文件或管道的缓冲区</td><td></td></tr><tr><td>getline</td><td>读入下一行</td><td>使用 getline 从文件 marks.txt 中读入一行并输出：<code>$ awk '&#123;getline; print $0&#125;' marks.txt</code>，AWK 从文件 marks.txt 中读入一行存储到变量 0 中。在下一条语句中，我们使用 getline 读入下一行。因此AWK读入第二行并存储到 0 中。最后，AWK 使用 print 输出第二行的内容。这个过程一直到文件结束。</td></tr><tr><td>next</td><td>停止处理当前记录，并且进入到下一条记录的处理过程。</td><td>当模式串匹配成功后程序并不执行任何操作：<code>$ awk '&#123;if ($0 ~/Shyam/) next; print $0&#125;' marks.txt</code></td></tr><tr><td>nextfile</td><td>停止处理当前文件，从下一个文件第一个记录开始处理。</td><td>首先创建两个文件。 file1.txt 内容如下:<code>file1:str1 file1:str2 file1:str3 file1:str4</code>文件 file2.txt 内容如下：<code>file2:str1 file2:str2 file2:str3 file2:str4</code>现在我们来测试 nextfile 函数。<code>$ awk '&#123; if ($0 ~ /file1:str2/) nextfile; print $0 &#125;' file1.txt file2.txt</code>输出结果为：<code>file1:str1 file2:str1 file2:str2 file2:str3 file2:str4</code></td></tr><tr><td>return</td><td>从用户自定义的函数中返回值。请注意，如果没有指定返回值，那么的返回值是未定义的。</td><td>创建文件 functions.awk，内容如下：<code>function addition(num1, num2) &#123; result = num1 + num2 return result &#125; BEGIN &#123; res = addition(10, 20) print &quot;10 + 20 = &quot; res &#125;</code>执行该文件：<code>$ awk -f functions.awk 10 + 20 = 30</code></td></tr><tr><td>system</td><td>执行特定的命令然后返回其退出状态。返回值为 0 表示命令执行成功；非 0 表示命令执行失败。</td><td><code>$ awk 'BEGIN &#123; ret = system(&quot;date&quot;); print &quot;Return value = &quot; ret &#125;'</code>输出结果为：<code>Sun Dec 21 23:16:07 IST 2014 Return value = 0</code></td></tr></tbody></table><p>本文参考：</p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Jerry00713/article/details/123867016">linux三剑客sed之模式空间与保持空间</a></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-heart"></i>感谢阅读-------------</div></div></div><div class="reward-container"><div>创作不易，您的支持将鼓励我继续创作！</div><button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/loading.jpeg" data-original="/images/wechatpay.png" alt="Corazon 微信支付"><p>微信支付</p></div><div style="display:inline-block"><img src="/images/loading.jpeg" data-original="/images/alipay.jpg" alt="Corazon 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>Corazon</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://www.mcorazon.top/posts/247a4e5f/" title="【Linux】Vim使用及文本处理">https://www.mcorazon.top/posts/247a4e5f/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/2b99b9f0/" rel="prev" title="【Linux】用户与权限管理"><i class="fa fa-chevron-left"></i> 【Linux】用户与权限管理</a></div><div class="post-nav-item"><a href="/posts/2d0621ba/" rel="next" title="【Linux】文件管理">【Linux】文件管理 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comment-button-group"><a class="btn comment-button gitalk">gitalk</a> <a class="btn comment-button valine">valine</a></div><div class="comment-position gitalk"><div class="comments" id="gitalk-container"></div></div><div class="comment-position valine"><div class="comments" id="valine-comments"></div></div><script>(function() {
          let commentButton = document.querySelectorAll('.comment-button');
            commentButton.forEach(element => {
            let commentClass = element.classList[2];
            element.addEventListener('click', () => {
              commentButton.forEach(rmActive => rmActive.classList.remove('active'));
              element.classList.add('active');
              document.querySelectorAll('.comment-position').forEach(rmActive => rmActive.classList.remove('active'));
              document.querySelector(`.comment-position.${commentClass}`).classList.add('active');
              if (CONFIG.comments.storage) {
                localStorage.setItem('comments_active', commentClass);
              }
            });
          });
          let { activeClass } = CONFIG.comments;
          if (CONFIG.comments.storage) {
            activeClass = localStorage.getItem('comments_active') || activeClass;
          }
          if (activeClass) {
            let activeButton = document.querySelector(`.comment-button.${activeClass}`);
            if (activeButton) {
              activeButton.click();
            }
          }
        })();</script><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#vim%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">1.</span> <span class="nav-text">vim的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-vim%EF%BC%9F"><span class="nav-number">1.1.</span> <span class="nav-text">什么是 vim？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vi-vim%E7%9A%84%E4%B8%89%E7%A7%8D%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.2.</span> <span class="nav-text">vi&#x2F;vim的三种模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BE%93%E5%85%A5%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.2.1.</span> <span class="nav-text">输入模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.2.2.</span> <span class="nav-text">命令模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%95%E8%A1%8C%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.2.3.</span> <span class="nav-text">底行模式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vim%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.</span> <span class="nav-text">vim基础操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E5%85%A5%E8%BE%93%E5%85%A5%E6%A8%A1%E5%BC%8F-Insert-mode"><span class="nav-number">1.3.1.</span> <span class="nav-text">进入输入模式(Insert mode)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E5%85%A5%E6%9B%BF%E6%8D%A2%E6%A8%A1%E5%BC%8F-Replace-mode"><span class="nav-number">1.3.2.</span> <span class="nav-text">进入替换模式(Replace mode)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.3.3.</span> <span class="nav-text">命令模式常用命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%AF%E8%A7%86%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.3.4.</span> <span class="nav-text">可视模式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VIM%E5%BF%AB%E9%80%9F%E5%A4%8D%E4%B9%A0"><span class="nav-number">1.4.</span> <span class="nav-text">VIM快速复习</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%89-%E5%86%92%E5%8F%B7%E5%8D%B3%E5%8F%AF%E8%BF%9B%E5%85%A5last-line-mode"><span class="nav-number">1.4.1.</span> <span class="nav-text">按:冒号即可进入last line mode</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8Ecommand-mode%E8%BF%9B%E5%85%A5Insert-mode"><span class="nav-number">1.4.2.</span> <span class="nav-text">从command mode进入Insert mode</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%89ESC%E9%94%AE%E9%80%80%E5%9B%9Ecommand-mode"><span class="nav-number">1.4.3.</span> <span class="nav-text">按ESC键退回command mode</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E8%A1%8C%E7%BC%96%E8%BE%91%EF%BC%8Cvim%E6%94%AF%E6%8C%81%EF%BC%8Cvi%E4%B8%8D%E6%94%AF%E6%8C%81"><span class="nav-number">1.4.4.</span> <span class="nav-text">多行编辑，vim支持，vi不支持</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vim%E7%BB%83%E4%B9%A0"><span class="nav-number">1.5.</span> <span class="nav-text">vim练习</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%88%E5%BE%85%E5%86%99%EF%BC%89"><span class="nav-number">2.</span> <span class="nav-text">正则表达式（待写）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux%E7%AE%A1%E9%81%93%E5%91%BD%E4%BB%A4"><span class="nav-number">3.</span> <span class="nav-text">Linux管道命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#wc-%E7%BB%9F%E8%AE%A1%E5%AD%97%E6%95%B0"><span class="nav-number">3.0.1.</span> <span class="nav-text">wc - 统计字数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#cut-%E5%88%97%E9%80%89%E5%8F%96%E5%91%BD%E4%BB%A4"><span class="nav-number">3.0.2.</span> <span class="nav-text">cut - 列选取命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#grep-%E8%A1%8C%E9%80%89%E5%8F%96%E5%91%BD%E4%BB%A4"><span class="nav-number">3.0.3.</span> <span class="nav-text">grep - 行选取命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sort-%E6%8E%92%E5%BA%8F"><span class="nav-number">3.0.4.</span> <span class="nav-text">sort - 排序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#uniq-%E5%8E%BB%E9%87%8D"><span class="nav-number">3.0.5.</span> <span class="nav-text">uniq - 去重</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tee-%E5%90%8C%E6%97%B6%E8%BE%93%E5%87%BA%E5%A4%9A%E4%B8%AA%E6%96%87%E4%BB%B6"><span class="nav-number">3.0.6.</span> <span class="nav-text">tee - 同时输出多个文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tr-%E6%9B%BF%E6%8D%A2%E6%8C%87%E5%AE%9A%E7%9A%84%E5%AD%97%E7%AC%A6"><span class="nav-number">3.0.7.</span> <span class="nav-text">tr - 替换指定的字符</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#join-%E6%96%87%E4%BB%B6%E6%8C%89%E8%A1%8C%E8%BF%9E%E6%8E%A5"><span class="nav-number">3.0.8.</span> <span class="nav-text">join - 文件按行连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#paste-%E5%B0%86%E5%A4%9A%E4%B8%AA%E6%96%87%E4%BB%B6%E5%AF%B9%E5%BA%94%E8%A1%8C%E9%93%BE%E6%8E%A5%E5%9C%A8%E4%B8%80%E8%B5%B7"><span class="nav-number">3.0.9.</span> <span class="nav-text">paste-将多个文件对应行链接在一起</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#split-%E6%96%87%E4%BB%B6%E5%88%87%E5%89%B2"><span class="nav-number">3.0.10.</span> <span class="nav-text">split - 文件切割</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xargs-%E5%8F%82%E6%95%B0%E4%BB%A3%E6%8D%A2"><span class="nav-number">3.0.11.</span> <span class="nav-text">xargs - 参数代换</span></a></li></ol></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%91%BD%E4%BB%A4"><span class="nav-number">4.</span> <span class="nav-text">文本编辑命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#cut%E5%91%BD%E4%BB%A4"><span class="nav-number">4.1.</span> <span class="nav-text">cut命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sed%E5%91%BD%E4%BB%A4"><span class="nav-number">4.2.</span> <span class="nav-text">sed命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%83%E5%AD%97%E7%AC%A6%E9%9B%86"><span class="nav-number">4.2.1.</span> <span class="nav-text">元字符集</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#a-i-%E5%9C%A8%E6%8C%87%E5%AE%9A%E8%A1%8C%E4%BD%8D%E7%BD%AE%E6%B7%BB%E5%8A%A0%E8%A1%8C"><span class="nav-number">4.2.2.</span> <span class="nav-text">a|i:在指定行位置添加行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#d-%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E8%A1%8C"><span class="nav-number">4.2.3.</span> <span class="nav-text">d:删除指定行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#c-%E6%9B%BF%E6%8D%A2%E6%8C%87%E5%AE%9A%E8%A1%8C"><span class="nav-number">4.2.4.</span> <span class="nav-text">c:替换指定行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#p-%E4%BB%85%E6%98%BE%E7%A4%BA%E6%8C%87%E5%AE%9A%E8%A1%8C"><span class="nav-number">4.2.5.</span> <span class="nav-text">p:仅显示指定行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#s-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9B%BF%E6%8D%A2"><span class="nav-number">4.2.6.</span> <span class="nav-text">s:字符串替换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#y-%E5%8D%95%E5%AD%97%E7%AC%A6%E6%9B%BF%E6%8D%A2"><span class="nav-number">4.2.7.</span> <span class="nav-text">y:单字符替换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hHgG%E6%A8%A1%E5%BC%8F%E7%A9%BA%E9%97%B4%E4%B8%8E%E4%BF%9D%E6%8C%81%E7%A9%BA%E9%97%B4"><span class="nav-number">4.2.8.</span> <span class="nav-text">hHgG模式空间与保持空间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E6%AC%A1%E6%8C%87%E5%AE%9A-e%E9%80%89%E9%A1%B9%E8%BF%9B%E8%A1%8C%E5%A4%9A%E7%82%B9%E7%BC%96%E8%BE%91"><span class="nav-number">4.2.9.</span> <span class="nav-text">多次指定-e选项进行多点编辑</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%89%E9%A1%B9-i%E7%9B%B4%E6%8E%A5%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="nav-number">4.2.10.</span> <span class="nav-text">选项-i直接修改文件内容</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#awk%E5%91%BD%E4%BB%A4"><span class="nav-number">4.3.</span> <span class="nav-text">awk命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-number">4.3.1.</span> <span class="nav-text">基本用法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AWK%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-number">4.3.2.</span> <span class="nav-text">AWK工作原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RS-ORS-FS-OFS%E5%8C%BA%E5%88%AB%E4%B8%8E%E8%81%94%E7%B3%BB"><span class="nav-number">4.3.3.</span> <span class="nav-text">RS,ORS,FS,OFS区别与联系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%B9%E9%85%8D"><span class="nav-number">4.3.4.</span> <span class="nav-text">正则字符串匹配</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E5%AE%9E%E4%BE%8B"><span class="nav-number">4.3.5.</span> <span class="nav-text">一些实例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#awk%E7%BC%96%E7%A8%8B"><span class="nav-number">4.4.</span> <span class="nav-text">awk编程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5IF-ELSE"><span class="nav-number">4.4.1.</span> <span class="nav-text">条件语句IF&amp;ELSE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5For-While"><span class="nav-number">4.4.2.</span> <span class="nav-text">循环语句For&amp;While</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#awk%E6%95%B0%E7%BB%84"><span class="nav-number">4.4.3.</span> <span class="nav-text">awk数组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AWK-%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="nav-number">4.4.4.</span> <span class="nav-text">AWK 用户自定义函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AWK-%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0"><span class="nav-number">4.4.5.</span> <span class="nav-text">AWK 内置函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%97%E6%95%B0%E5%87%BD%E6%95%B0"><span class="nav-number">4.4.6.</span> <span class="nav-text">算数函数</span></a></li></ol></li></ol></li></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Corazon" src="/images/006.png"><p class="site-author-name" itemprop="name">Corazon</p><div class="site-description" itemprop="description"><font color="#000000">这世界总有黑夜<br>可我们总发着光</font></div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">33</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">18</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Corazon-hacker" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Corazon-hacker" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://www.runoob.com/" title="https:&#x2F;&#x2F;www.runoob.com&#x2F;" rel="noopener" target="_blank">菜鸟教程</a></li><li class="links-of-blogroll-item"><a href="http://c.biancheng.net/sitemap/" title="http:&#x2F;&#x2F;c.biancheng.net&#x2F;sitemap&#x2F;" rel="noopener" target="_blank">C语言中文网</a></li><li class="links-of-blogroll-item"><a href="https://csdiy.wiki/" title="https:&#x2F;&#x2F;csdiy.wiki&#x2F;" rel="noopener" target="_blank">CS自学指南</a></li><li class="links-of-blogroll-item"><a href="https://www.r2coding.com/#/" title="https:&#x2F;&#x2F;www.r2coding.com&#x2F;#&#x2F;" rel="noopener" target="_blank">Road To Coding</a></li><li class="links-of-blogroll-item"><a href="https://hackway.org/docs/cs/intro" title="https:&#x2F;&#x2F;hackway.org&#x2F;docs&#x2F;cs&#x2F;intro" rel="noopener" target="_blank">计算机专业学习路线</a></li></ul></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div><script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script><script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script><div class="widget-wrap"><h3 class="widget-title">标签云</h3><div id="myCanvasContainer" class="widget tagcloud"><canvas width="250" height="250" id="resCanvas"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MYSQL/" rel="tag">MYSQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PortSwigger%E9%9D%B6%E5%9C%BA/" rel="tag">PortSwigger靶场</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL%E6%B3%A8%E5%85%A5/" rel="tag">SQL注入</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Typora/" rel="tag">Typora</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XSS/" rel="tag">XSS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/private/" rel="tag">private</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlmap/" rel="tag">sqlmap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/upload-lab%E9%9D%B6%E5%9C%BA/" rel="tag">upload-lab靶场</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="tag">反序列化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" rel="tag">文件上传</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86/" rel="tag">路径遍历</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%B6%E5%9C%BA/" rel="tag">靶场</a><span class="tag-list-count">1</span></li></ul></canvas></div></div></div></aside><div id="sidebar-dimmer"></div></div></main></div><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Corazon</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span title="站点总字数">260k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">3:57</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer><script color="0,0,255" opacity="1" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/code-unfold.js"></script><script src="/js/local-search.js"></script><script>if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }</script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'Ov23liioqYUgEl2eGVTc',
      clientSecret: '268a15cf6d039e6e17da820b0bd4824725bbce6d',
      repo        : 'Corazon-hacker.github.io',
      owner       : 'Corazon-hacker',
      admin       : ['Corazon-hacker'],
      id          : '68b419933d247de99ba9c4847faabf3c',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});</script><script>NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : '02iDSwDgb06k5K8yx5oSD85t-gzGzoHsz',
      appKey     : 'eA8vZdwW4UasH3SiNapGvXh5',
      placeholder: "你是我一生只会遇见一次的惊喜 ...",
      avatar     : 'monsterid',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : 'https://02idswdg.lc-cn-n1-shared.com'
    });
  }, window.Valine);
});</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><link href="https://cdn.bootcss.com/gitalk/1.4.0/gitalk.min.css" rel="stylesheet"><script src="https://cdn.bootcss.com/gitalk/1.4.0/gitalk.min.js"></script><script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script><script type="text/javascript">var gitalk = new Gitalk({
    clientID: '',
    clientSecret: '',
    repo: 'Corazon-hacker.github.io',
    owner: '',
    admin: [''],
    id: md5(location.pathname),   // ISSUE：location.href 限制50个字符 (应该是Issue 内容存数据库的标识， 具体在页面上无感)
    labels: ''.split(',').filter(l => l),  // 需要的 labels需要一个数组，否则会报错
    perPage: ,
    pagerDirection: '',
    createIssueManually: ,
    distractionFreeMode: 
  })
  gitalk.render('gitalk-container')</script><style>[bg-lazy]{background-image:none!important;background-color:#eee!important}</style><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body></html>